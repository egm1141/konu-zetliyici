<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>PageCraft</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{background:#0e0e14;color:#eee;font-family:'Outfit',sans-serif;height:100vh;display:flex;flex-direction:column;overflow:hidden;user-select:none;}

/* ---- TOPBAR ---- */
.topbar{height:52px;background:#13131c;border-bottom:1px solid #1e1e2e;display:flex;align-items:center;padding:0 16px;gap:10px;flex-shrink:0;}
.logo{font-family:'Syne',sans-serif;font-size:19px;font-weight:800;color:#fff;letter-spacing:-0.5px;}
.logo b{color:#7c6fff;}
.tbtn{padding:6px 13px;border-radius:8px;border:1px solid #252535;background:#1a1a28;color:#ccc;font-size:12px;cursor:pointer;font-family:'Outfit',sans-serif;transition:all .15s;display:flex;align-items:center;gap:5px;}
.tbtn:hover{border-color:#7c6fff;color:#7c6fff;background:#1e1e30;}
.tbtn.pri{background:linear-gradient(135deg,#7c6fff,#9d6fff);border-color:transparent;color:#fff;font-weight:600;}
.tbtn.pri:hover{background:linear-gradient(135deg,#6a5ee0,#8a5ee0);}
.sep{width:1px;height:28px;background:#1e1e2e;}
.sp{flex:1;}

/* ---- MAIN ---- */
.main{display:flex;flex:1;overflow:hidden;}

/* ---- RAIL ---- */
.rail{width:62px;background:#13131c;border-right:1px solid #1e1e2e;display:flex;flex-direction:column;align-items:center;padding:10px 0;gap:3px;flex-shrink:0;}
.rb{width:50px;height:50px;border-radius:10px;border:1px solid transparent;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .15s;color:#444;font-size:17px;gap:2px;}
.rb span{font-size:8px;color:#444;letter-spacing:.3px;}
.rb:hover{background:#1a1a28;color:#888;}
.rb.on{background:#1e1e30;border-color:#7c6fff;color:#7c6fff;}
.rb.on span{color:#7c6fff;}

/* ---- SIDE ---- */
.side{width:275px;background:#13131c;border-right:1px solid #1e1e2e;overflow-y:auto;flex-shrink:0;}
.side::-webkit-scrollbar{width:4px;}
.side::-webkit-scrollbar-thumb{background:#252535;border-radius:99px;}
.pb{padding:14px;}
.pl{font-size:10px;letter-spacing:1.5px;text-transform:uppercase;color:#444;font-weight:700;margin-bottom:10px;}

/* Template grid */
.tgrid{display:grid;grid-template-columns:1fr 1fr;gap:8px;}
.tc{background:#1a1a28;border:1.5px solid #1e1e2e;border-radius:10px;padding:12px 8px;cursor:pointer;text-align:center;transition:all .18s;position:relative;overflow:hidden;}
.tc::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(124,111,255,.0),rgba(124,111,255,.08));opacity:0;transition:opacity .18s;}
.tc:hover{border-color:#7c6fff;transform:translateY(-1px);box-shadow:0 4px 16px rgba(124,111,255,.15);}
.tc:hover::before{opacity:1;}
.tc-ico{font-size:22px;margin-bottom:5px;}
.tc-name{font-size:10px;color:#777;font-weight:500;}

/* Inputs */
.si{width:100%;background:#1a1a28;border:1px solid #1e1e2e;border-radius:8px;padding:7px 10px;color:#eee;font-size:12px;font-family:'Outfit',sans-serif;outline:none;margin-bottom:7px;}
.si:focus{border-color:#7c6fff;}
.ss{width:100%;background:#1a1a28;border:1px solid #1e1e2e;border-radius:8px;padding:7px 9px;color:#eee;font-size:12px;font-family:'Outfit',sans-serif;outline:none;cursor:pointer;margin-bottom:7px;}
.ss:focus{border-color:#7c6fff;}

/* Colors */
.cgrid{display:grid;grid-template-columns:repeat(6,1fr);gap:5px;margin-bottom:8px;}
.cd{aspect-ratio:1;border-radius:5px;cursor:pointer;border:2px solid transparent;transition:all .15s;}
.cd:hover{border-color:#fff;transform:scale(1.12);}
.ci{display:flex;gap:7px;align-items:center;margin-bottom:8px;}
.ci input[type=color]{width:34px;height:34px;border:none;border-radius:6px;cursor:pointer;padding:1px;background:#1a1a28;}
.ci input[type=text]{flex:1;background:#1a1a28;border:1px solid #1e1e2e;border-radius:7px;padding:6px 8px;color:#eee;font-size:11px;font-family:monospace;outline:none;}
.ci input[type=text]:focus{border-color:#7c6fff;}

/* Style buttons */
.sbs{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:8px;}
.sbt{width:32px;height:32px;border-radius:6px;border:1px solid #1e1e2e;background:#1a1a28;color:#eee;font-size:12px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .15s;}
.sbt:hover{background:#7c6fff;border-color:#7c6fff;color:#fff;}
.abs{display:flex;gap:5px;margin-bottom:8px;}
.abt{flex:1;height:30px;border-radius:6px;border:1px solid #1e1e2e;background:#1a1a28;color:#666;font-size:14px;cursor:pointer;transition:all .15s;}
.abt:hover{background:#7c6fff;border-color:#7c6fff;color:#fff;}

/* Photo upload */
.da{border:2px dashed #252535;border-radius:10px;padding:24px 12px;text-align:center;cursor:pointer;transition:all .2s;background:#171724;position:relative;margin-bottom:10px;}
.da:hover,.da.ov{border-color:#7c6fff;background:rgba(124,111,255,.06);}
.da input{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;}
.pgrid{display:grid;grid-template-columns:1fr 1fr;gap:7px;}
.pth{aspect-ratio:1;border-radius:8px;overflow:hidden;border:2px solid #1e1e2e;cursor:pointer;position:relative;transition:border-color .15s;}
.pth:hover{border-color:#7c6fff;}
.pth img{width:100%;height:100%;object-fit:cover;display:block;}
.pth .pd{position:absolute;top:3px;right:3px;background:rgba(0,0,0,.7);border:none;border-radius:50%;width:18px;height:18px;color:#fff;font-size:9px;cursor:pointer;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .15s;}
.pth:hover .pd{opacity:1;}

/* Shapes */
.shgrid{display:grid;grid-template-columns:repeat(4,1fr);gap:7px;}
.shb{aspect-ratio:1;border-radius:8px;border:1px solid #1e1e2e;background:#1a1a28;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px;transition:all .15s;}
.shb:hover{border-color:#7c6fff;background:#1e1e30;}

/* Stickers */
.egrid{display:grid;grid-template-columns:repeat(5,1fr);gap:5px;}
.eb{aspect-ratio:1;border-radius:8px;background:#1a1a28;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:19px;transition:all .15s;border:1px solid transparent;}
.eb:hover{border-color:#7c6fff;transform:scale(1.1);}

/* Background swatches */
.bggrid{display:grid;grid-template-columns:repeat(3,1fr);gap:7px;margin-bottom:10px;}
.bgsw{aspect-ratio:4/3;border-radius:9px;cursor:pointer;border:2px solid transparent;transition:all .15s;}
.bgsw:hover{border-color:#7c6fff;transform:scale(1.04);}

.dv{height:1px;background:#1e1e2e;margin:10px 0;}

/* Draw tool buttons */
.drw-tools{display:grid;grid-template-columns:1fr 1fr;gap:7px;margin-bottom:10px;}
.dtb{background:#1a1a28;border:1.5px solid #1e1e2e;border-radius:9px;padding:10px 6px;cursor:pointer;text-align:center;transition:all .16s;font-size:11px;color:#888;}
.dtb:hover{border-color:#7c6fff;color:#ccc;}
.dtb.on{background:#1e1e30;border-color:#7c6fff;color:#7c6fff;}
.dtb-ico{font-size:20px;margin-bottom:4px;}
.drw-size{display:flex;gap:6px;align-items:center;margin-bottom:8px;}
.dsz{width:28px;height:28px;border-radius:50%;border:2px solid #1e1e2e;background:#1a1a28;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .15s;}
.dsz:hover,.dsz.on{border-color:#7c6fff;}
.dsz span{background:#eee;border-radius:50%;display:block;}

/* Draw canvas overlay */
#drawLayer{position:absolute;top:0;left:0;width:794px;pointer-events:none;z-index:200;}
#drawLayer.active{pointer-events:all;cursor:crosshair;}

/* ---- CANVAS ---- */
.cw{flex:1;overflow:auto;background:#0a0a10;display:flex;align-items:flex-start;justify-content:center;padding:28px;}
.cw::-webkit-scrollbar{width:8px;height:8px;}
.cw::-webkit-scrollbar-thumb{background:#1e1e2e;border-radius:99px;}
#a4{width:794px;min-height:1123px;background:#fff;position:relative;overflow:hidden;box-shadow:0 24px 80px rgba(0,0,0,.9);border-radius:3px;flex-shrink:0;}

/* ---- ELEMENTS ---- */
.el{position:absolute;cursor:move;}
.el.sel .ei{outline:2px solid #7c6fff;outline-offset:1px;}
.el.locked{cursor:not-allowed;}
.el.locked .ei{outline-color:#f5c842!important;}

/* ---- TEXT BOX - YENƒ∞ TASARIM ---- */
.ei{
  width:100%;
  height:100%;
  position:relative;
  border-radius:2px;
}

/* Text element inner wrapper */
.et-wrap {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: relative;
  border-radius: 2px;
}

.et{
  width:100%;
  height:100%;
  padding:8px 10px;
  font-size:15px;
  line-height:1.5;
  outline:none;
  white-space:pre-wrap;
  word-break:break-word;
  overflow-wrap:break-word;
  cursor:text;
  min-width:30px;
  min-height:20px;
  /* Ta≈ümayƒ± engelle */
  overflow:hidden;
  display:block;
  box-sizing:border-box;
}

/* Se√ßili metin kutusu g√∂r√ºn√ºm√º */
.el.sel.type-text .et-wrap {
  outline: none;
}

/* Text box dashed border hint when selected */
.el.type-text .ei::before {
  content:'';
  position:absolute;
  inset:0;
  border:1.5px dashed transparent;
  border-radius:2px;
  pointer-events:none;
  transition:border-color .15s;
}
.el.type-text:hover .ei::before,
.el.type-text.sel .ei::before {
  border-color:rgba(124,111,255,0.4);
}

.eimg{width:100%;height:100%;object-fit:cover;display:block;pointer-events:none;}
.esvg{width:100%;height:100%;overflow:visible;}

/* ---- RESIZE HANDLES (8 y√∂nl√º) ---- */
.rh-se{position:absolute;width:10px;height:10px;background:#7c6fff;border:2px solid #fff;border-radius:2px;bottom:-5px;right:-5px;cursor:se-resize;z-index:10;display:none;}
.rh-s{position:absolute;width:10px;height:10px;background:#7c6fff;border:2px solid #fff;border-radius:2px;bottom:-5px;left:50%;transform:translateX(-50%);cursor:s-resize;z-index:10;display:none;}
.rh-e{position:absolute;width:10px;height:10px;background:#7c6fff;border:2px solid #fff;border-radius:2px;right:-5px;top:50%;transform:translateY(-50%);cursor:e-resize;z-index:10;display:none;}
.rh-n{position:absolute;width:10px;height:10px;background:#7c6fff;border:2px solid #fff;border-radius:2px;top:-5px;left:50%;transform:translateX(-50%);cursor:n-resize;z-index:10;display:none;}
.rh-w{position:absolute;width:10px;height:10px;background:#7c6fff;border:2px solid #fff;border-radius:2px;left:-5px;top:50%;transform:translateY(-50%);cursor:w-resize;z-index:10;display:none;}
.rh-ne{position:absolute;width:10px;height:10px;background:#7c6fff;border:2px solid #fff;border-radius:2px;top:-5px;right:-5px;cursor:ne-resize;z-index:10;display:none;}
.rh-sw{position:absolute;width:10px;height:10px;background:#7c6fff;border:2px solid #fff;border-radius:2px;bottom:-5px;left:-5px;cursor:sw-resize;z-index:10;display:none;}
.rh-nw{position:absolute;width:10px;height:10px;background:#7c6fff;border:2px solid #fff;border-radius:2px;top:-5px;left:-5px;cursor:nw-resize;z-index:10;display:none;}

.dh{position:absolute;top:-11px;right:-11px;width:20px;height:20px;background:#f44;border:2px solid #fff;border-radius:50%;cursor:pointer;font-size:9px;color:#fff;display:none;align-items:center;justify-content:center;z-index:10;}

.el.sel .rh-se,
.el.sel .rh-s,
.el.sel .rh-e,
.el.sel .rh-n,
.el.sel .rh-w,
.el.sel .rh-ne,
.el.sel .rh-sw,
.el.sel .rh-nw{display:block;}
.el.sel .dh{display:flex;}

/* ---- PROPS ---- */
.props{width:215px;background:#13131c;border-left:1px solid #1e1e2e;padding:14px;overflow-y:auto;flex-shrink:0;}
.props::-webkit-scrollbar{width:4px;}
.props::-webkit-scrollbar-thumb{background:#252535;border-radius:99px;}
.prow{display:flex;align-items:center;justify-content:space-between;margin-bottom:9px;gap:7px;}
.plbl{font-size:11px;color:#555;flex-shrink:0;}
.pin{flex:1;background:#1a1a28;border:1px solid #1e1e2e;border-radius:6px;padding:5px 7px;color:#eee;font-size:11px;text-align:right;font-family:'Outfit',sans-serif;outline:none;}
.pin:focus{border-color:#7c6fff;}
.osl{width:100%;-webkit-appearance:none;height:4px;border-radius:99px;background:#1e1e2e;outline:none;cursor:pointer;margin-bottom:12px;}
.osl::-webkit-slider-thumb{-webkit-appearance:none;width:14px;height:14px;border-radius:50%;background:#7c6fff;cursor:pointer;border:2px solid #fff;}
.lbs{display:flex;gap:4px;flex-wrap:wrap;}
.lb{flex:1;min-width:50px;padding:6px 4px;border-radius:6px;border:1px solid #1e1e2e;background:#1a1a28;color:#bbb;font-size:10px;cursor:pointer;text-align:center;transition:all .15s;font-family:'Outfit',sans-serif;}
.lb:hover{border-color:#7c6fff;color:#7c6fff;}
.lb.red:hover{border-color:#f44;color:#f44;}
.lb.gold:hover{border-color:#f5c842;color:#f5c842;}
.ep{font-size:11px;color:#333;text-align:center;margin-top:40px;line-height:1.7;}

/* ---- CONTEXT MENU ---- */
.ctx-menu{position:fixed;background:#1a1a28;border:1px solid #2a2a3e;border-radius:12px;padding:6px;min-width:195px;z-index:9999;box-shadow:0 10px 40px rgba(0,0,0,.8),0 2px 8px rgba(0,0,0,.6);display:none;animation:ctxIn .12s ease;}
@keyframes ctxIn{from{opacity:0;transform:scale(.96) translateY(-4px);}to{opacity:1;transform:scale(1) translateY(0);}}
.ctx-item{display:flex;align-items:center;gap:9px;padding:7px 10px;border-radius:7px;cursor:pointer;font-size:12px;color:#ccc;transition:all .12s;}
.ctx-item:hover{background:#252540;color:#fff;}
.ctx-item.danger:hover{background:rgba(244,68,68,.12);color:#f44;}
.ctx-item.warn:hover{background:rgba(245,200,66,.12);color:#f5c842;}
.ctx-item .ci-ico{font-size:14px;width:18px;text-align:center;flex-shrink:0;}
.ctx-item .ci-key{margin-left:auto;font-size:10px;color:#444;background:#111;padding:1px 5px;border-radius:3px;}
.ctx-sep{height:1px;background:#1e1e2e;margin:4px 0;}
.ctx-label{font-size:9px;color:#444;letter-spacing:1.5px;text-transform:uppercase;padding:6px 10px 3px;font-weight:700;}

/* ---- TOAST ---- */
.toast{position:fixed;bottom:22px;right:22px;background:#1a1a28;border:1px solid #252535;border-left:3px solid #7c6fff;color:#eee;padding:10px 15px;border-radius:10px;font-size:12px;z-index:9999;opacity:0;transform:translateY(6px);transition:all .25s;pointer-events:none;}
.toast.show{opacity:1;transform:translateY(0);}

/* ---- MODAL ---- */
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:500;overflow:auto;padding:40px 20px;backdrop-filter:blur(4px);}
.mbox{background:#13131c;border:1px solid #1e1e2e;border-radius:16px;width:820px;max-width:100%;margin:0 auto;padding:28px;}
.mhead{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;}
.mtitle{font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:#fff;}
.mclose{background:#1a1a28;border:1px solid #1e1e2e;color:#888;border-radius:8px;padding:7px 14px;cursor:pointer;font-size:13px;transition:all .15s;}
.mclose:hover{border-color:#7c6fff;color:#7c6fff;}
.mgrid{display:grid;grid-template-columns:repeat(5,1fr);gap:10px;}
.mc{background:#1a1a28;border:1.5px solid #1e1e2e;border-radius:12px;padding:16px 8px;cursor:pointer;text-align:center;transition:all .18s;position:relative;overflow:hidden;}
.mc::after{content:'';position:absolute;inset:0;background:linear-gradient(135deg,rgba(124,111,255,.15),transparent);opacity:0;transition:opacity .18s;}
.mc:hover{border-color:#7c6fff;transform:translateY(-2px);box-shadow:0 6px 20px rgba(124,111,255,.2);}
.mc:hover::after{opacity:1;}
.mc-ico{font-size:26px;margin-bottom:8px;}
.mc-name{font-size:11px;color:#888;font-weight:600;}
.mc-cat{font-size:9px;color:#444;margin-top:3px;letter-spacing:.5px;}

/* Lock overlay */
.lock-badge{position:absolute;top:-5px;left:-5px;width:18px;height:18px;background:#f5c842;border:2px solid #fff;border-radius:50%;display:none;align-items:center;justify-content:center;font-size:8px;z-index:11;}
.el.locked .lock-badge{display:flex;}

@media print{
  .topbar,.rail,.side,.props,.ctx-menu{display:none!important;}
  body{background:#fff;}
  .cw{padding:0;background:#fff;}
  #a4{box-shadow:none;width:100%;}
  .el.sel .ei{outline:none;}
  .el.type-text .ei::before{display:none;}
  .rh-se,.rh-s,.rh-e,.rh-n,.rh-w,.rh-ne,.rh-sw,.rh-nw,.dh,.lock-badge{display:none!important;}
}
</style>
</head>
<body>
<div class="topbar">
  <div class="logo">Page<b>Craft</b></div>
  <div class="sep"></div>
  <button class="tbtn" onclick="openModal()">‚äû ≈ûablonlar (25)</button>
  <button class="tbtn" onclick="addTxt('body')">T+ Metin</button>
  <button class="tbtn" onclick="undoLast()">‚Ü© Geri Al</button>
  <button class="tbtn" onclick="clearAll()">‚äò Temizle</button>
  <div class="sp"></div>
  <button class="tbtn pri" onclick="window.print()">üñ® Yazdƒ±r / PDF</button>
</div>
<div class="main">
  <div class="rail">
    <div class="rb on" id="rb_tpl" onclick="showP('tpl',this)">üìÑ<span>≈ûablon</span></div>
    <div class="rb" id="rb_txt" onclick="showP('txt',this)">T<span>Metin</span></div>
    <div class="rb" id="rb_img" onclick="showP('img',this)">üì∑<span>Foto</span></div>
    <div class="rb" id="rb_shp" onclick="showP('shp',this)">‚¨ú<span>≈ûekil</span></div>
    <div class="rb" id="rb_stk" onclick="showP('stk',this)">‚≠ê<span>Etiket</span></div>
    <div class="rb" id="rb_bg" onclick="showP('bg',this)">üé®<span>Arkaplan</span></div>
    <div class="rb" id="rb_fnt" onclick="showP('fnt',this)">Aa<span>Yazƒ±</span></div>
    <div class="rb" id="rb_drw" onclick="showP('drw',this)">‚úèÔ∏è<span>√áizim</span></div>
  </div>
  <div class="side" id="sidePanel"></div>
  <div class="cw" id="cw" onclick="desel(event)" oncontextmenu="canvasCtx(event)">
    <div id="a4">
      <canvas id="drawLayer"></canvas>
    </div>
  </div>
  <div class="props" id="props">
    <div class="pl">√ñzellikler</div>
    <div class="ep" id="ep">Bir eleman se√ßin<br>veya saƒü tƒ±klayƒ±n</div>
    <div id="pf" style="display:none"></div>
  </div>
</div>
<div class="toast" id="toast"></div>

<!-- Context Menu -->
<div class="ctx-menu" id="ctxMenu">
  <div class="ctx-label" id="ctxTitle">Eleman</div>
  <div id="ctxEl">
    <div class="ctx-item" onclick="ctx_copy()"><span class="ci-ico">üìã</span> Kopyala <span class="ci-key">Ctrl+D</span></div>
    <div class="ctx-item" onclick="ctx_cut()"><span class="ci-ico">‚úÇÔ∏è</span> Kes</div>
    <div class="ctx-item" onclick="ctx_paste()"><span class="ci-ico">üìå</span> Yapƒ±≈ütƒ±r <span class="ci-key">Ctrl+V</span></div>
    <div class="ctx-sep"></div>
    <div class="ctx-item" onclick="bF()"><span class="ci-ico">‚¨ÜÔ∏è</span> √ñne Getir</div>
    <div class="ctx-item" onclick="sB()"><span class="ci-ico">‚¨áÔ∏è</span> Arkaya G√∂nder</div>
    <div class="ctx-sep"></div>
    <div class="ctx-item" onclick="ctx_lock()" id="ctxLockBtn"><span class="ci-ico">üîí</span> Kilitle</div>
    <div class="ctx-item" onclick="ctx_group()"><span class="ci-ico">üóÇ</span> Grupla (yakƒ±nda)</div>
    <div class="ctx-sep"></div>
    <div class="ctx-item" onclick="ctx_flipH()"><span class="ci-ico">‚ÜîÔ∏è</span> Yatay √áevir</div>
    <div class="ctx-item" onclick="ctx_flipV()"><span class="ci-ico">‚ÜïÔ∏è</span> Dikey √áevir</div>
    <div class="ctx-sep"></div>
    <div class="ctx-item danger" onclick="ctx_del()"><span class="ci-ico">üóë</span> Sil <span class="ci-key">Del</span></div>
  </div>
  <div id="ctxCanvas">
    <div class="ctx-item" onclick="ctx_paste()"><span class="ci-ico">üìå</span> Yapƒ±≈ütƒ±r</div>
    <div class="ctx-item" onclick="undoLast()"><span class="ci-ico">‚Ü©Ô∏è</span> Geri Al <span class="ci-key">Ctrl+Z</span></div>
    <div class="ctx-sep"></div>
    <div class="ctx-item" onclick="selectAll()"><span class="ci-ico">‚ä°</span> T√ºm√ºn√º Se√ß <span class="ci-key">Ctrl+A</span></div>
    <div class="ctx-sep"></div>
    <div class="ctx-item warn" onclick="clearAll()"><span class="ci-ico">‚äò</span> T√ºm√ºn√º Temizle</div>
  </div>
</div>

<!-- Modal -->
<div class="modal" id="modal">
  <div class="mbox">
    <div class="mhead">
      <div class="mtitle">‚ú¶ ≈ûablon Se√ßin ‚Äî 25 Hazƒ±r Format</div>
      <button class="mclose" onclick="closeModal()">‚úï Kapat</button>
    </div>
    <div class="mgrid" id="mgrid"></div>
  </div>
</div>

<script>
var els=[],selId=null,lastSelId=null,undoStack=[],photos=[],elCnt=0,isDrag=false;
var isRes=false,resDir='se';
var dOff={x:0,y:0},rSt={x:0,y:0,w:0,h:0,elx:0,ely:0};
var A4=document.getElementById('a4');
var clipboard=null;
var ctxTargetId=null;
// Drawing state
var drawMode=null;
var drawColor='#e74c3c';
var drawSize=3;
var isDrawing=false;
var drawStart={x:0,y:0};
var drawCanvas=null;
var drawCtx=null;
var drawPts=[];

var TPLS=[
  {id:'blank',ico:'üóã',name:'Bo≈ü Sayfa',cat:'Temel'},
  {id:'summary',ico:'üìù',name:'√ñzet',cat:'Belge'},
  {id:'bullets',ico:'üìã',name:'Maddeler',cat:'Belge'},
  {id:'mindmap',ico:'üß†',name:'Zihin Haritasƒ±',cat:'Planlama'},
  {id:'report',ico:'üìä',name:'Rapor',cat:'ƒ∞≈ü'},
  {id:'table',ico:'üìä',name:'Tablo',cat:'Veri'},
  {id:'notes',ico:'üìì',name:'Defter',cat:'Ki≈üisel'},
  {id:'resume',ico:'üë§',name:'CV',cat:'Kariyer'},
  {id:'timeline',ico:'‚è±',name:'Zaman √áizelgesi',cat:'Planlama'},
  {id:'cover',ico:'üé®',name:'Kapak',cat:'Tasarƒ±m'},
  {id:'invoice',ico:'üßæ',name:'Fatura',cat:'ƒ∞≈ü'},
  {id:'poster',ico:'üìå',name:'Afis',cat:'Tasarƒ±m'},
  {id:'recipe',ico:'üçΩ',name:'Tarif',cat:'Ya≈üam'},
  {id:'flyer',ico:'üì¢',name:'El ƒ∞lanƒ±',cat:'Tasarƒ±m'},
  {id:'newsletter',ico:'üì∞',name:'B√ºlten',cat:'ƒ∞√ßerik'},
  {id:'certificate',ico:'üèÜ',name:'Sertifika',cat:'Resmi'},
  {id:'quiz',ico:'‚ùì',name:'Sƒ±nav',cat:'Eƒüitim'},
  {id:'schedule',ico:'üìÖ',name:'Program',cat:'Planlama'},
  {id:'proposal',ico:'üíº',name:'Teklif',cat:'ƒ∞≈ü'},
  {id:'journal',ico:'üìñ',name:'G√ºnl√ºk',cat:'Ki≈üisel'},
  {id:'comparison',ico:'‚öñ',name:'Kar≈üƒ±la≈ütƒ±rma',cat:'Analiz'},
  {id:'swot',ico:'üéØ',name:'SWOT',cat:'Analiz'},
  {id:'kanban',ico:'üìÅ',name:'Kanban',cat:'Planlama'},
  {id:'infographic',ico:'üìà',name:'ƒ∞nfografik',cat:'G√∂rsel'},
  {id:'moodboard',ico:'‚ú®',name:'Mood Board',cat:'Tasarƒ±m'}
];

// ---- PANEL ----
function showP(name,btn){
  document.querySelectorAll('.rb').forEach(function(b){b.classList.remove('on');});
  btn.classList.add('on');
  buildPanel(name);
}

function buildPanel(name){
  var sp=document.getElementById('sidePanel');
  var h='';
  if(name==='tpl'){
    h='<div class="pb"><div class="pl">≈ûablonlar</div><div class="tgrid">';
    TPLS.forEach(function(t){
      h+='<div class="tc" onclick="applyTpl(\''+t.id+'\')" title="'+t.cat+'">'
        +'<div class="tc-ico">'+t.ico+'</div>'
        +'<div class="tc-name">'+t.name+'</div>'
        +'</div>';
    });
    h+='</div></div>';
  } else if(name==='txt'){
    h='<div class="pb"><div class="pl">Metin Ekle</div>';
    var txts=[['heading','B√ºy√ºk Ba≈ülƒ±k','36px ¬∑ Kalƒ±n'],['sub','Alt Ba≈ülƒ±k','20px ¬∑ Orta'],['body','Paragraf','14px'],['caption','A√ßƒ±klama','11px'],['quote','"Alƒ±ntƒ±"','16px ¬∑ ƒ∞talik']];
    txts.forEach(function(v){
      h+='<div class="tc" style="text-align:left;padding:10px 12px;margin-bottom:7px;" onclick="addTxt(\''+v[0]+'\')"><div style="font-weight:600;color:#eee;font-size:13px;">'+v[1]+'</div><div style="font-size:10px;color:#555;margin-top:2px;">'+v[2]+'</div></div>';
    });
    h+='</div>';
  } else if(name==='img'){
    h='<div class="pb"><div class="pl">Fotoƒüraflar</div>'
     +'<div class="da" id="da"><input type="file" accept="image/*" multiple onchange="uploadP(this.files)">'
     +'<div style="font-size:28px;margin-bottom:6px;">üì∑</div>'
     +'<div style="font-size:12px;color:#555;">Fotoƒüraf ekle veya<br><b style="color:#7c6fff">s√ºr√ºkle bƒ±rak</b></div>'
     +'</div><div class="pgrid" id="pgrid"></div></div>';
  } else if(name==='shp'){
    var shapes=[['rect','‚¨õ'],['circle','‚¨§'],['triangle','‚ñ≤'],['diamond','‚óÜ'],['star','‚òÖ'],['line','‚îÅ'],['rounded','‚ñ¨'],['arrow','‚û§'],['hexagon','‚¨°'],['plus','‚úö']];
    h='<div class="pb"><div class="pl">≈ûekiller</div><div class="shgrid">';
    shapes.forEach(function(s){h+='<div class="shb" onclick="addShp(\''+s[0]+'\')">'+s[1]+'</div>';});
    h+='</div><div class="dv"></div><div class="pl">Renk</div><div class="cgrid">';
    ['#7c6fff','#ff6584','#f5c842','#38ef7d','#2193b0','#1a1a2e','#fff','#f44','#ff8c42','#a855f7','#11998e','#e65100'].forEach(function(c){
      h+='<div class="cd" style="background:'+c+'" onclick="applyShpColor(\''+c+'\')"></div>';
    });
    h+='</div><div class="ci"><input type="color" value="#7c6fff" oninput="applyShpColor(this.value)"><input type="text" value="#7c6fff" placeholder="#renk" oninput="applyShpColor(this.value)"></div></div>';
  } else if(name==='stk'){
    var stks=['‚≠ê','üî•','üí°','‚úÖ','‚ùå','‚ö†Ô∏è','üéØ','üìå','üîë','üíé','üöÄ','üåü','üí™','üéâ','üèÜ','‚ú®','üé®','üìù','üîî','üíº','üëç','‚ù§Ô∏è','üåô','‚òÄÔ∏è','‚ö°'];
    h='<div class="pb"><div class="pl">√áƒ±kartmalar</div><div class="egrid">';
    stks.forEach(function(s){h+='<div class="eb" onclick="addStk(\''+s+'\')">'+s+'</div>';});
    h+='</div></div>';
  } else if(name==='bg'){
    var bgs=[
      'background:#fff','background:#faf8f3','background:#f0f0f5',
      'background:#1a1a2e','background:#111','background:#fffde7',
      'background:linear-gradient(135deg,#7c6fff,#a855f7)',
      'background:linear-gradient(135deg,#ff6584,#ff8c42)',
      'background:linear-gradient(135deg,#11998e,#38ef7d)',
      'background:linear-gradient(135deg,#2193b0,#6dd5ed)',
      'background:#fff;background-image:repeating-linear-gradient(0deg,transparent,transparent 27px,#ddd 28px)',
      'background:#fff;background-image:linear-gradient(#e5e5e5 1px,transparent 1px),linear-gradient(90deg,#e5e5e5 1px,transparent 1px);background-size:28px 28px'
    ];
    window._bgs=bgs;
    h='<div class="pb"><div class="pl">Arkaplan</div><div class="bggrid">';
    bgs.forEach(function(b,i){h+='<div class="bgsw" style="'+b+'" onclick="applyBg('+i+')"></div>';});
    h+='</div><div class="ci"><input type="color" value="#ffffff" oninput="A4.style.background=this.value"><input type="text" placeholder="#ffffff" oninput="A4.style.background=this.value"></div></div>';
  } else if(name==='fnt'){
    h='<div class="pb"><div class="pl">Yazƒ± Tipi</div>'
     +'<select class="ss" onchange="applyFF(this.value)">'
     +"<option value=\"'Outfit',sans-serif\">Outfit</option>"
     +"<option value=\"'Syne',sans-serif\">Syne</option>"
     +'<option value="Georgia,serif">Georgia</option>'
     +'<option value="\'Times New Roman\',serif">Times New Roman</option>'
     +'<option value="\'Courier New\',monospace">Courier New</option>'
     +'<option value="Arial,sans-serif">Arial</option>'
     +'</select>'
     +'<div class="pl">Boyut</div>'
     +'<select class="ss" onchange="applyFS(this.value)">';
    [8,10,11,12,13,14,16,18,20,22,24,28,32,36,40,48,56,64,72,80,96].forEach(function(s){
      h+='<option value="'+s+'px"'+(s===14?' selected':'')+'>'+s+'</option>';
    });
    h+='</select><div class="pl">Stil</div><div class="sbs">'
     +'<button class="sbt" onclick="applyB()"><b>B</b></button>'
     +'<button class="sbt" onclick="applyI()"><i>I</i></button>'
     +'<button class="sbt" onclick="applyU()"><u>U</u></button>'
     +'</div><div class="pl">Hizala</div><div class="abs">'
     +'<button class="abt" onclick="applyA(\'left\')">‚áê</button>'
     +'<button class="abt" onclick="applyA(\'center\')">‚Üî</button>'
     +'<button class="abt" onclick="applyA(\'right\')">‚áí</button>'
     +'</div><div class="pl">Renk</div><div class="cgrid">';
    ['#1a1a1a','#fff','#7c6fff','#ff6584','#f5c842','#38ef7d','#2193b0','#f44','#888','#000','#a855f7','#e65100'].forEach(function(c){
      h+='<div class="cd" style="background:'+c+';'+(c==='#fff'?'border:1px solid #333;':'')+'" onclick="applyTC(\''+c+'\')"></div>';
    });
    h+='</div><div class="ci"><input type="color" value="#1a1a1a" oninput="applyTC(this.value)"><input type="text" value="#1a1a1a" oninput="applyTC(this.value)"></div></div>';
  } else if(name==='drw'){
    h='<div class="pb"><div class="pl">√áizim Ara√ßlarƒ±</div>'
     +'<div class="drw-tools">'
     +'<div class="dtb'+(drawMode==='pen'?' on':'')+'" id="dtb_pen" onclick="setDrawMode(\'pen\')"><div class="dtb-ico">‚úèÔ∏è</div>Serbest</div>'
     +'<div class="dtb'+(drawMode==='line'?' on':'')+'" id="dtb_line" onclick="setDrawMode(\'line\')"><div class="dtb-ico">‚ï±</div>√áizgi</div>'
     +'<div class="dtb'+(drawMode==='arrow'?' on':'')+'" id="dtb_arrow" onclick="setDrawMode(\'arrow\')"><div class="dtb-ico">‚û°</div>Ok</div>'
     +'<div class="dtb'+(drawMode==='dbl_arrow'?' on':'')+'" id="dtb_dbl_arrow" onclick="setDrawMode(\'dbl_arrow\')"><div class="dtb-ico">‚Üî</div>√áift Ok</div>'
     +'<div class="dtb'+(drawMode==='rect_draw'?' on':'')+'" id="dtb_rect_draw" onclick="setDrawMode(\'rect_draw\')"><div class="dtb-ico">‚ñ≠</div>Dikd√∂rtgen</div>'
     +'<div class="dtb'+(drawMode==='ellipse_draw'?' on':'')+'" id="dtb_ellipse_draw" onclick="setDrawMode(\'ellipse_draw\')"><div class="dtb-ico">‚¨≠</div>Elips</div>'
     +'</div>'
     +'<div class="dv"></div>'
     +'<div class="pl">Kalem Kalƒ±nlƒ±ƒüƒ±</div>'
     +'<div class="drw-size">'
     +'<div class="dsz'+(drawSize===2?' on':'')+'" onclick="setDrawSize(2)"><span style="width:4px;height:4px;"></span></div>'
     +'<div class="dsz'+(drawSize===4?' on':'')+'" onclick="setDrawSize(4)"><span style="width:7px;height:7px;"></span></div>'
     +'<div class="dsz'+(drawSize===8?' on':'')+'" onclick="setDrawSize(8)"><span style="width:12px;height:12px;"></span></div>'
     +'<div class="dsz'+(drawSize===14?' on':'')+'" onclick="setDrawSize(14)"><span style="width:18px;height:18px;"></span></div>'
     +'</div>'
     +'<div class="dv"></div>'
     +'<div class="pl">Renk</div><div class="cgrid">';
    ['#1a1a1a','#fff','#e74c3c','#f5c842','#2ecc71','#3498db','#7c6fff','#ff6584','#e67e22','#1abc9c','#9b59b6','#34495e'].forEach(function(c){
      h+='<div class="cd" style="background:'+c+';'+(c==='#fff'?'border:1px solid #444;':'')+'"'
        +' onclick="setDrawColor(\''+c+'\')" '+(drawColor===c?'style="background:'+c+';border:2px solid #7c6fff;"':'')+' ></div>';
    });
    h+='</div>'
     +'<div class="ci"><input type="color" value="'+drawColor+'" oninput="setDrawColor(this.value)" id="drawColorPicker"><input type="text" value="'+drawColor+'" oninput="setDrawColor(this.value)" id="drawColorTxt"></div>'
     +'<div class="dv"></div>'
     +'<button class="tbtn" style="width:100%;justify-content:center;margin-bottom:7px;" onclick="clearDrawings()">üóë √áizimleri Temizle</button>'
     +'<button class="tbtn pri" style="width:100%;justify-content:center;" onclick="stopDrawMode()">‚úì √áizimi Bitir</button>'
     +'</div>';
  }
  sp.innerHTML=h;
  if(name==='img'){setupDrop();renderPG();}
}

// ---- PHOTOS ----
function setupDrop(){
  var da=document.getElementById('da');
  if(!da)return;
  da.addEventListener('dragover',function(e){e.preventDefault();da.classList.add('ov');});
  da.addEventListener('dragleave',function(){da.classList.remove('ov');});
  da.addEventListener('drop',function(e){e.preventDefault();da.classList.remove('ov');uploadP(e.dataTransfer.files);});
}
function uploadP(files){
  Array.from(files).forEach(function(f){
    var r=new FileReader();
    r.onload=function(e){photos.push(e.target.result);renderPG();toast('Fotoƒüraf eklendi');};
    r.readAsDataURL(f);
  });
}
function renderPG(){
  var g=document.getElementById('pgrid');
  if(!g)return;
  g.innerHTML=photos.map(function(src,i){
    return '<div class="pth" onclick="addImg('+i+')">'
     +'<img src="'+src+'">'
     +'<button class="pd" onclick="event.stopPropagation();photos.splice('+i+',1);renderPG()">X</button>'
     +'</div>';
  }).join('');
}

// ---- CREATE EL ----
function mkEl(type,cfg){
  saveUndo();
  var id='e'+(++elCnt);
  var el={id:id,type:type,x:cfg.x||60,y:cfg.y||60,w:cfg.w||200,h:cfg.h||50,cnt:cfg.cnt||'',st:cfg.st||{},shp:cfg.shp||null,img:cfg.img!=null?cfg.img:null,z:els.length+1,locked:false,flipH:false,flipV:false};
  els.push(el);
  drawEl(el);
  return el;
}

function drawEl(el){
  var old=document.getElementById(el.id);
  if(old)old.remove();
  var div=document.createElement('div');
  div.className='el'+(el.locked?' locked':'')+(el.type==='text'?' type-text':'');
  div.id=el.id;
  div.style.left=el.x+'px';div.style.top=el.y+'px';
  div.style.width=el.w+'px';div.style.height=el.h+'px';
  div.style.zIndex=el.z;
  if(el.st&&el.st.opacity!=null)div.style.opacity=el.st.opacity;
  var transform='';
  if(el.flipH)transform+='scaleX(-1)';
  if(el.flipV)transform+=(transform?' ':'')+'scaleY(-1)';
  if(transform)div.style.transform=transform;

  var inner=document.createElement('div');inner.className='ei';

  if(el.type==='text'){
    // Text box with overflow wrapper
    var wrap=document.createElement('div');wrap.className='et-wrap';
    var t=document.createElement('div');t.className='et';t.contentEditable=el.locked?'false':'true';t.innerHTML=el.cnt;
    applyStyle(t,el.st);
    t.addEventListener('input',function(){el.cnt=t.innerHTML;});
    t.addEventListener('mousedown',function(e){e.stopPropagation();});
    wrap.appendChild(t);
    inner.appendChild(wrap);
  } else if(el.type==='image'){
    var img=document.createElement('img');img.className='eimg';img.src=photos[el.img];inner.appendChild(img);
  } else if(el.type==='shape'){
    var svg=mkSVG(el);inner.appendChild(svg);
  } else if(el.type==='sticker'){
    var sd=document.createElement('div');
    sd.style.cssText='width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:'+(el.h*0.65)+'px;';
    sd.innerHTML=el.cnt;inner.appendChild(sd);
  }

  // Lock badge
  var lb=document.createElement('div');lb.className='lock-badge';lb.textContent='üîí';inner.appendChild(lb);

  // 8 resize handles
  var dirs=['nw','n','ne','w','e','sw','s','se'];
  dirs.forEach(function(d){
    var rh=document.createElement('div');rh.className='rh-'+d;rh.dataset.dir=d;
    rh.addEventListener('mousedown',startRes);
    inner.appendChild(rh);
  });

  var dh=document.createElement('div');dh.className='dh';dh.textContent='√ó';
  dh.addEventListener('mousedown',function(e){e.stopPropagation();delEl(el.id);});inner.appendChild(dh);

  div.appendChild(inner);
  div.addEventListener('mousedown',startDrag);
  div.addEventListener('contextmenu',function(e){e.preventDefault();e.stopPropagation();selEl(el.id);showCtxEl(e,el);});
  A4.appendChild(div);
}

function applyStyle(el,st){
  if(!st)return;
  if(st.fontSize)el.style.fontSize=st.fontSize;
  if(st.fontWeight)el.style.fontWeight=st.fontWeight;
  if(st.fontStyle)el.style.fontStyle=st.fontStyle;
  if(st.fontFamily)el.style.fontFamily=st.fontFamily;
  if(st.color)el.style.color=st.color;
  if(st.textAlign)el.style.textAlign=st.textAlign;
  if(st.textDecoration)el.style.textDecoration=st.textDecoration;
  if(st.lineHeight)el.style.lineHeight=st.lineHeight;
  if(st.background)el.style.background=st.background;
  if(st.padding)el.style.padding=st.padding;
}

function mkSVG(el){
  var svg=document.createElementNS('http://www.w3.org/2000/svg','svg');
  svg.setAttribute('width','100%');svg.setAttribute('height','100%');svg.style.overflow='visible';
  var c=(el.st&&el.st.fill)||'#7c6fff';
  var m={
    rect:'<rect x="1" y="1" width="99%" height="99%" fill="'+c+'"/>',
    rounded:'<rect x="1" y="1" width="99%" height="99%" rx="10" fill="'+c+'"/>',
    circle:'<ellipse cx="50%" cy="50%" rx="49%" ry="49%" fill="'+c+'"/>',
    triangle:'<polygon points="50%,2% 98%,98% 2%,98%" fill="'+c+'"/>',
    diamond:'<polygon points="50%,2% 98%,50% 50%,98% 2%,50%" fill="'+c+'"/>',
    star:'<polygon points="50%,5% 61%,35% 98%,35% 68%,57% 79%,91% 50%,70% 21%,91% 32%,57% 2%,35% 39%,35%" fill="'+c+'"/>',
    line:'<line x1="0" y1="50%" x2="100%" y2="50%" stroke="'+c+'" stroke-width="4"/>',
    arrow:'<polygon points="60%,15% 98%,50% 60%,85% 60%,65% 2%,65% 2%,35% 60%,35%" fill="'+c+'"/>',
    hexagon:'<polygon points="25%,2% 75%,2% 98%,50% 75%,98% 25%,98% 2%,50%" fill="'+c+'"/>',
    plus:'<rect x="40%" y="5%" width="20%" height="90%" fill="'+c+'"/><rect x="5%" y="40%" width="90%" height="20%" fill="'+c+'"/>'
  };
  svg.innerHTML=m[el.shp]||m.rect;
  return svg;
}

// ---- DRAG ----
function startDrag(e){
  if(e.target.classList.contains('dh'))return;
  if(e.target.dataset&&e.target.dataset.dir)return; // resize handle
  var div=e.currentTarget;
  var elData=gEl(div.id);
  if(elData&&elData.locked){selEl(div.id);return;}
  selEl(div.id);
  if(e.target.contentEditable==='true')return;
  isDrag=true;
  dOff.x=e.clientX-div.offsetLeft;
  dOff.y=e.clientY-div.offsetTop;
  e.preventDefault();
  document.addEventListener('mousemove',onDrag);
  document.addEventListener('mouseup',stopDrag);
}
function onDrag(e){
  if(!isDrag||!selId)return;
  var div=document.getElementById(selId);if(!div)return;
  var el=gEl(selId);
  el.x=Math.max(0,e.clientX-dOff.x);
  el.y=Math.max(0,e.clientY-dOff.y);
  div.style.left=el.x+'px';div.style.top=el.y+'px';
  refProps();
}
function stopDrag(){isDrag=false;document.removeEventListener('mousemove',onDrag);document.removeEventListener('mouseup',stopDrag);}

// ---- RESIZE (8 y√∂nl√º) ----
function startRes(e){
  e.stopPropagation();e.preventDefault();
  var el=gEl(selId);if(el&&el.locked)return;
  isRes=true;
  resDir=e.target.dataset.dir||'se';
  var div=document.getElementById(selId);
  rSt={
    x:e.clientX,y:e.clientY,
    w:div.offsetWidth,h:div.offsetHeight,
    elx:el.x,ely:el.y
  };
  document.addEventListener('mousemove',onRes);
  document.addEventListener('mouseup',stopRes);
}
function onRes(e){
  if(!isRes||!selId)return;
  var el=gEl(selId),div=document.getElementById(selId);
  var dx=e.clientX-rSt.x,dy=e.clientY-rSt.y;
  var nw=rSt.w,nh=rSt.h,nx=rSt.elx,ny=rSt.ely;

  // Calculate new dimensions based on direction
  if(resDir==='se'){nw=Math.max(30,rSt.w+dx);nh=Math.max(20,rSt.h+dy);}
  else if(resDir==='s'){nh=Math.max(20,rSt.h+dy);}
  else if(resDir==='e'){nw=Math.max(30,rSt.w+dx);}
  else if(resDir==='n'){nh=Math.max(20,rSt.h-dy);ny=rSt.ely+dy;}
  else if(resDir==='w'){nw=Math.max(30,rSt.w-dx);nx=rSt.elx+dx;}
  else if(resDir==='ne'){nw=Math.max(30,rSt.w+dx);nh=Math.max(20,rSt.h-dy);ny=rSt.ely+dy;}
  else if(resDir==='sw'){nw=Math.max(30,rSt.w-dx);nh=Math.max(20,rSt.h+dy);nx=rSt.elx+dx;}
  else if(resDir==='nw'){nw=Math.max(30,rSt.w-dx);nh=Math.max(20,rSt.h-dy);nx=rSt.elx+dx;ny=rSt.ely+dy;}

  // Clamp position
  nx=Math.max(0,nx);ny=Math.max(0,ny);

  el.w=nw;el.h=nh;el.x=nx;el.y=ny;
  div.style.width=nw+'px';div.style.height=nh+'px';
  div.style.left=nx+'px';div.style.top=ny+'px';

  if(el.type==='sticker'){var sd=div.querySelector('.ei>div');if(sd)sd.style.fontSize=(nh*0.65)+'px';}
  refProps();
}
function stopRes(){isRes=false;document.removeEventListener('mousemove',onRes);document.removeEventListener('mouseup',stopRes);}

// ---- SELECT ----
function selEl(id){
  desel();selId=id;lastSelId=id;
  var div=document.getElementById(id);if(div)div.classList.add('sel');
  refProps();
}
function desel(e){
  if(e&&e.target.closest&&(e.target.closest('.el')||e.target.closest('.props')||e.target.closest('.side')))return;
  document.querySelectorAll('.el').forEach(function(d){d.classList.remove('sel');});
  selId=null;
  document.getElementById('ep').style.display='block';
  document.getElementById('pf').style.display='none';
}
function gEl(id){return els.find(function(e){return e.id===id;});}
function delEl(id){saveUndo();els=els.filter(function(e){return e.id!==id;});var d=document.getElementById(id);if(d)d.remove();selId=null;desel();}

function selectAll(){els.forEach(function(el){var d=document.getElementById(el.id);if(d)d.classList.add('sel');});if(els.length>0){selId=els[els.length-1].id;refProps();}}

function refProps(){
  if(!selId)return;
  var el=gEl(selId);if(!el)return;
  document.getElementById('ep').style.display='none';
  var pf=document.getElementById('pf');pf.style.display='block';
  var lockLbl=el.locked?'üîì Kilidi A√ß':'üîí Kilitle';
  pf.innerHTML=
    '<div class="prow"><span class="plbl">X</span><input class="pin" type="number" value="'+Math.round(el.x)+'" onchange="mvP(\'x\',this.value)"></div>'
   +'<div class="prow"><span class="plbl">Y</span><input class="pin" type="number" value="'+Math.round(el.y)+'" onchange="mvP(\'y\',this.value)"></div>'
   +'<div class="prow"><span class="plbl">Geni≈ülik</span><input class="pin" type="number" value="'+Math.round(el.w)+'" onchange="szP(\'w\',this.value)"></div>'
   +'<div class="prow"><span class="plbl">Y√ºkseklik</span><input class="pin" type="number" value="'+Math.round(el.h)+'" onchange="szP(\'h\',this.value)"></div>'
   +'<div class="plbl">Opaklƒ±k</div>'
   +'<input class="osl" type="range" min="0" max="100" value="'+Math.round((el.st.opacity!=null?el.st.opacity:1)*100)+'" oninput="setOp(this.value)">'
   +'<div class="dv"></div><div class="lbs">'
   +'<button class="lb" onclick="bF()">‚¨Ü √ñne</button>'
   +'<button class="lb" onclick="sB()">‚¨á Arkaya</button>'
   +'<button class="lb" onclick="dupE()">‚äï Kopyala</button>'
   +'<button class="lb gold" onclick="ctx_lock()">'+lockLbl+'</button>'
   +'<button class="lb" onclick="ctx_flipH()">‚Üî √áevir</button>'
   +'<button class="lb red" onclick="delEl(\''+el.id+'\')">üóë Sil</button>'
   +'</div>';
}
function mvP(ax,v){var el=gEl(selId);if(!el)return;el[ax]=+v;var d=document.getElementById(selId);if(d)d.style[ax==='x'?'left':'top']=v+'px';}
function szP(d,v){var el=gEl(selId);if(!el)return;el[d]=+v;var div=document.getElementById(selId);if(div)div.style[d==='w'?'width':'height']=v+'px';}
function setOp(v){var el=gEl(selId);if(!el)return;el.st.opacity=v/100;document.getElementById(selId).style.opacity=v/100;}
function bF(){var el=gEl(selId);if(!el)return;var mx=Math.max.apply(null,els.map(function(e){return e.z;}))+1;el.z=mx;document.getElementById(selId).style.zIndex=mx;}
function sB(){var el=gEl(selId);if(!el)return;var mn=Math.max(1,Math.min.apply(null,els.map(function(e){return e.z;}))-1);el.z=mn;document.getElementById(selId).style.zIndex=mn;}
function dupE(){var el=gEl(selId);if(!el)return;var ne=mkEl(el.type,{x:el.x+18,y:el.y+18,w:el.w,h:el.h,cnt:el.cnt,st:Object.assign({},el.st),shp:el.shp,img:el.img});selEl(ne.id);toast('Kopyalandƒ±');}

// ---- CONTEXT MENU ----
function showCtxEl(e,el){
  var menu=document.getElementById('ctxMenu');
  document.getElementById('ctxTitle').textContent=el.type==='text'?'‚úè Metin':el.type==='image'?'üñº G√∂rsel':el.type==='shape'?'‚óÜ ≈ûekil':'‚≠ê √áƒ±kartma';
  document.getElementById('ctxEl').style.display='block';
  document.getElementById('ctxCanvas').style.display='none';
  var lockBtn=document.getElementById('ctxLockBtn');
  lockBtn.innerHTML='<span class="ci-ico">'+(el.locked?'üîì':'üîí')+'</span> '+(el.locked?'Kilidi A√ß':'Kilitle');
  ctxTargetId=el.id;
  posCtx(menu,e);
}
function canvasCtx(e){
  var elDiv=e.target.closest('.el');
  if(elDiv){return;}
  e.preventDefault();
  var menu=document.getElementById('ctxMenu');
  document.getElementById('ctxTitle').textContent='üìÑ Tuval';
  document.getElementById('ctxEl').style.display='none';
  document.getElementById('ctxCanvas').style.display='block';
  ctxTargetId=null;
  posCtx(menu,e);
}
function posCtx(menu,e){
  menu.style.display='block';
  var x=e.clientX,y=e.clientY;
  var mw=200,mh=280;
  if(x+mw>window.innerWidth)x=window.innerWidth-mw-8;
  if(y+mh>window.innerHeight)y=window.innerHeight-mh-8;
  menu.style.left=x+'px';menu.style.top=y+'px';
}
function hideCtx(){document.getElementById('ctxMenu').style.display='none';}
document.addEventListener('mousedown',function(e){if(!e.target.closest('#ctxMenu'))hideCtx();});
document.addEventListener('scroll',hideCtx);

function ctx_copy(){var el=gEl(ctxTargetId||selId);if(!el)return;clipboard=JSON.parse(JSON.stringify(el));toast('Kopyalandƒ± ‚úì');hideCtx();}
function ctx_cut(){var el=gEl(ctxTargetId||selId);if(!el)return;clipboard=JSON.parse(JSON.stringify(el));delEl(el.id);toast('Kesildi');hideCtx();}
function ctx_paste(){
  if(!clipboard)return;
  var c=JSON.parse(JSON.stringify(clipboard));
  c.x+=20;c.y+=20;
  var ne=mkEl(c.type,{x:c.x,y:c.y,w:c.w,h:c.h,cnt:c.cnt,st:Object.assign({},c.st),shp:c.shp,img:c.img});
  selEl(ne.id);toast('Yapƒ±≈ütƒ±rƒ±ldƒ± ‚úì');hideCtx();
}
function ctx_del(){var id=ctxTargetId||selId;if(id)delEl(id);hideCtx();}
function ctx_lock(){
  var id=ctxTargetId||selId;var el=gEl(id);if(!el)return;
  el.locked=!el.locked;
  var div=document.getElementById(id);
  if(div){div.classList.toggle('locked',el.locked);}
  var t=div&&div.querySelector('.et');
  if(t)t.contentEditable=el.locked?'false':'true';
  toast(el.locked?'üîí Kilitlendi':'üîì Kilit a√ßƒ±ldƒ±');
  refProps();hideCtx();
}
function ctx_flipH(){
  var id=ctxTargetId||selId;var el=gEl(id);if(!el)return;
  el.flipH=!el.flipH;
  var div=document.getElementById(id);
  if(div){var t='';if(el.flipH)t+='scaleX(-1)';if(el.flipV)t+=(t?' ':'')+'scaleY(-1)';div.style.transform=t;}
  toast('Yatay √ßevrildi');hideCtx();
}
function ctx_flipV(){
  var id=ctxTargetId||selId;var el=gEl(id);if(!el)return;
  el.flipV=!el.flipV;
  var div=document.getElementById(id);
  if(div){var t='';if(el.flipH)t+='scaleX(-1)';if(el.flipV)t+=(t?' ':'')+'scaleY(-1)';div.style.transform=t;}
  toast('Dikey √ßevrildi');hideCtx();
}
function ctx_group(){toast('Gruplama yakƒ±nda geliyor!');hideCtx();}

// ---- STYLE ----
function getActiveId(){return selId||lastSelId;}
function aTS(fn){var id=getActiveId();if(!id)return;var el=gEl(id);var div=document.getElementById(id);if(el&&div)fn(el,div);}
function gTxt(div){return div?div.querySelector('.et'):null;}
function applyTC(c){aTS(function(el,div){el.st.color=c;var t=gTxt(div);if(t){t.style.color=c;}});toast('Renk uygulandƒ±');}
function applyFF(f){aTS(function(el,div){el.st.fontFamily=f;var t=gTxt(div);if(t){t.style.fontFamily=f;}});toast('Yazƒ± tipi deƒüi≈ütirildi');}
function applyFS(s){aTS(function(el,div){el.st.fontSize=s;var t=gTxt(div);if(t){t.style.fontSize=s;}});toast('Boyut: '+s);}
function applyB(){aTS(function(el,div){var t=gTxt(div);if(!t)return;var b=window.getComputedStyle(t).fontWeight;var nb=(parseInt(b)>=600)?'400':'700';t.style.fontWeight=nb;el.st.fontWeight=nb;});}
function applyI(){aTS(function(el,div){var t=gTxt(div);if(!t)return;var c=window.getComputedStyle(t).fontStyle;var ni=c==='italic'?'normal':'italic';t.style.fontStyle=ni;el.st.fontStyle=ni;});}
function applyU(){aTS(function(el,div){var t=gTxt(div);if(!t)return;var cur=window.getComputedStyle(t).textDecoration;t.style.textDecoration=cur.indexOf('underline')>=0?'none':'underline';el.st.textDecoration=t.style.textDecoration;});}
function applyA(a){aTS(function(el,div){var t=gTxt(div);if(t){t.style.textAlign=a;el.st.textAlign=a;}});}
function applyShpColor(c){aTS(function(el,div){if(el.type!=='shape')return;el.st.fill=c;var svg=div.querySelector('svg');if(svg){var ns=mkSVG(el);div.querySelector('.ei').replaceChild(ns,svg);}});}
function applyBg(i){var bg=window._bgs[i];if(!bg)return;A4.style.cssText=bg+';width:794px;min-height:1123px;position:relative;overflow:hidden;box-shadow:0 24px 80px rgba(0,0,0,.9);border-radius:3px;flex-shrink:0;';toast('Arkaplan deƒüi≈ütirildi');}

// ---- ADD HELPERS ----
function addTxt(v){
  var m={
    heading:{cnt:'B√ºy√ºk Ba≈ülƒ±k',st:{fontSize:'34px',fontWeight:'700',fontFamily:"'Syne',sans-serif",color:'#1a1a1a'},w:450,h:60},
    sub:{cnt:'Alt Ba≈ülƒ±k',st:{fontSize:'20px',fontWeight:'600',fontFamily:"'Outfit',sans-serif",color:'#1a1a1a'},w:350,h:44},
    body:{cnt:'Metninizi buraya yazƒ±n...',st:{fontSize:'14px',fontFamily:"'Outfit',sans-serif",color:'#2a2a2a',lineHeight:'1.7'},w:350,h:80},
    caption:{cnt:'A√ßƒ±klama metni',st:{fontSize:'11px',color:'#888'},w:220,h:32},
    quote:{cnt:'"Alƒ±ntƒ± metni buraya gelir"',st:{fontSize:'16px',fontStyle:'italic',color:'#555',fontFamily:'Georgia,serif'},w:340,h:60}
  };
  var cfg=m[v]||m.body;
  var ne=mkEl('text',{cnt:cfg.cnt,st:cfg.st,w:cfg.w,h:cfg.h,x:80,y:80+els.length*14});
  selEl(ne.id);toast('Metin kutusu eklendi ‚Äî kenarlardan boyutlandƒ±rƒ±n');
}
function addShp(shp){var ne=mkEl('shape',{shp:shp,st:{fill:'#7c6fff'},w:130,h:80,x:80,y:80+els.length*8});selEl(ne.id);}
function addStk(em){var ne=mkEl('sticker',{cnt:em,w:60,h:60,x:100,y:100+els.length*6});selEl(ne.id);}
function addImg(idx){var ne=mkEl('image',{img:parseInt(idx),w:220,h:170,x:80,y:80+els.length*8});selEl(ne.id);}

// ---- UNDO / CLEAR ----
function saveUndo(){undoStack.push(A4.innerHTML);if(undoStack.length>20)undoStack.shift();}
function undoLast(){
  if(!undoStack.length)return;
  var saved=undoStack.pop();
  Array.from(A4.children).forEach(function(c){if(c.id!=='drawLayer')c.remove();});
  var tmp=document.createElement('div');tmp.innerHTML=saved;
  Array.from(tmp.children).forEach(function(c){if(c.id!=='drawLayer')A4.appendChild(c);});
  els=[];selId=null;lastSelId=null;
  toast('Geri alƒ±ndƒ±');
}
function clearAll(silent){
  saveUndo();
  Array.from(A4.children).forEach(function(c){if(c.id!=='drawLayer')c.remove();});
  els=[];selId=null;lastSelId=null;
  A4.style.cssText='background:#fff;width:794px;min-height:1123px;position:relative;overflow:hidden;box-shadow:0 24px 80px rgba(0,0,0,.9);border-radius:3px;flex-shrink:0;';
  if(!silent)toast('Temizlendi');
}

// ---- MODAL ----
function openModal(){
  var g=document.getElementById('mgrid');
  g.innerHTML=TPLS.map(function(t){
    return '<div class="mc" onclick="applyTpl(\''+t.id+'\');closeModal()">'
     +'<div class="mc-ico">'+t.ico+'</div>'
     +'<div class="mc-name">'+t.name+'</div>'
     +'<div class="mc-cat">'+t.cat+'</div></div>';
  }).join('');
  document.getElementById('modal').style.display='block';
}
function closeModal(){document.getElementById('modal').style.display='none';}
document.getElementById('modal').addEventListener('click',function(e){if(e.target===this)closeModal();});

// ---- TEMPLATES ----
function applyTpl(id){clearAll(true);var fn=TFNS[id];if(fn)fn();else toast(id+' y√ºklendi');}

function qt(text,x,y,w,h,s){return mkEl('text',{cnt:text,x:x,y:y,w:w||300,h:h||36,st:s||{}});}
function qs(shp,x,y,w,h,fill){return mkEl('shape',{shp:shp,x:x,y:y,w:w,h:h,st:{fill:fill||'#7c6fff'}});}

var TFNS={
  blank:function(){},

  summary:function(){
    A4.style.background='#fff';
    qs('rect',0,0,794,6,'linear-gradient(90deg,#7c6fff,#a855f7)');
    qs('rect',0,6,794,88,'#f8f7ff');
    qt('<b>BA≈ûLIK BURAYA GELƒ∞R</b>',52,18,670,58,{fontSize:'28px',fontFamily:"'Syne',sans-serif",fontWeight:'800',color:'#1a1a2e'});
    qt('Tarih ¬∑ Yazar ¬∑ Kaynak',52,72,450,22,{fontSize:'11px',color:'#aaa',letterSpacing:'.5px'});
    qs('rect',0,94,794,1,'#ede9ff');
    qt('Bu b√∂l√ºme konuya giri≈ü yapƒ±lƒ±r. √ñzet neden √∂nemli, ne kapsƒ±yor?',52,116,690,55,{fontSize:'14px',lineHeight:'1.8',color:'#2a2a2a'});
    qs('circle',42,190,12,12,'#7c6fff');
    qs('rect',54,195,690,2,'#ede9ff');
    qt('ƒ∞kinci paragraf daha fazla detay i√ßerir ve konuyu derinle≈ütirir.',52,210,690,60,{fontSize:'14px',lineHeight:'1.8',color:'#2a2a2a'});
    qs('circle',42,280,12,12,'#a855f7');
    qs('rect',54,285,690,2,'#ede9ff');
    qt('Sonu√ß ve √ßƒ±karƒ±mlar buraya yazƒ±lƒ±r. Anahtar mesaj vurgulanƒ±r.',52,300,690,55,{fontSize:'14px',lineHeight:'1.8',color:'#2a2a2a'});
    qs('rounded',52,390,200,72,'#f8f7ff');
    qt('üìå Anahtar Nokta',58,400,188,22,{fontSize:'11px',fontWeight:'700',color:'#7c6fff'});
    qt('Kƒ±sa a√ßƒ±klama buraya',58,424,188,28,{fontSize:'12px',color:'#555'});
    qs('rounded',268,390,200,72,'#f8f7ff');
    qt('üìä Veri / Oran',274,400,188,22,{fontSize:'11px',fontWeight:'700',color:'#a855f7'});
    qt('Sayƒ±sal deƒüer buraya',274,424,188,28,{fontSize:'12px',color:'#555'});
    qs('rounded',484,390,262,72,'#f8f7ff');
    qt('üí° √ñnemli Bilgi',490,400,250,22,{fontSize:'11px',fontWeight:'700',color:'#11998e'});
    qt('Vurgulanan detay',490,424,250,28,{fontSize:'12px',color:'#555'});
  },

  bullets:function(){
    A4.style.background='#fff';
    qs('rect',0,0,794,80,'#1a1a2e');
    qs('rect',0,80,794,4,'#7c6fff');
    qt('MADDE MADDE',52,16,600,48,{fontSize:'26px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('Alt ba≈ülƒ±k veya a√ßƒ±klama',52,60,400,20,{fontSize:'11px',color:'rgba(255,255,255,.4)'});
    var y=110;
    var sections=[
      {title:'B√ñL√úM 1',color:'#7c6fff',items:['Birinci madde i√ßeriƒüi ve a√ßƒ±klamasƒ±','ƒ∞kinci madde i√ßeriƒüi','√ú√ß√ºnc√º madde a√ßƒ±klamasƒ±']},
      {title:'B√ñL√úM 2',color:'#ff6584',items:['D√∂rd√ºnc√º madde','Be≈üinci madde a√ßƒ±klamasƒ±','Altƒ±ncƒ± madde']},
      {title:'B√ñL√úM 3',color:'#38ef7d',items:['Yedinci madde','Sekizinci madde a√ßƒ±klamasƒ±']}
    ];
    sections.forEach(function(sec){
      qs('rounded',52,y,6,sec.items.length*38+10,sec.color);
      qt(sec.title,68,y+2,350,22,{fontSize:'9px',fontWeight:'800',color:sec.color,letterSpacing:'2.5px'});y+=28;
      sec.items.forEach(function(item){
        qs('circle',68,y+6,7,7,sec.color);
        qt(item,82,y,650,28,{fontSize:'13.5px',color:'#2a2a2a',lineHeight:'1.7'});y+=36;
      });
      y+=20;
    });
  },

  mindmap:function(){
    A4.style.background='linear-gradient(160deg,#f8f7ff 0%,#fff 60%,#f0f0fa 100%)';
    qt('Zihin Haritasƒ±',190,28,414,40,{fontSize:'20px',fontWeight:'800',fontFamily:"'Syne',sans-serif",color:'#1a1a2e',textAlign:'center'});
    qs('rect',190,68,414,2,'#ede9ff');
    qs('circle',307,445,190,110,'#7c6fff');
    qt('MERKEZ<br>KONU',315,486,175,42,{fontSize:'13px',fontWeight:'800',color:'#fff',textAlign:'center',fontFamily:"'Syne',sans-serif"});
    var nodes=[{t:'Dal 1',x:48,y:290,c:'#a855f7'},{t:'Dal 2',x:540,y:290,c:'#ff6584'},{t:'Dal 3',x:48,y:460,c:'#2193b0'},{t:'Dal 4',x:540,y:460,c:'#38ef7d'},{t:'Dal 5',x:180,y:178,c:'#f5c842'},{t:'Dal 6',x:420,y:178,c:'#e65100'},{t:'Dal 7',x:165,y:660,c:'#11998e'},{t:'Dal 8',x:455,y:660,c:'#7c6fff'}];
    nodes.forEach(function(n){
      qs('rounded',n.x,n.y,155,48,n.c);
      qt(n.t,n.x+6,n.y+12,142,26,{fontSize:'12px',fontWeight:'700',color:'#fff',textAlign:'center'});
    });
  },

  report:function(){
    qs('rect',0,0,794,100,'#1a1a2e');
    qs('rect',0,96,794,4,'#7c6fff');
    qt('RAPOR BA≈ûLIƒûI',52,20,550,50,{fontSize:'26px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('D√∂nem: 2024 ¬∑ Hazƒ±rlayan: Ad Soyad',52,74,400,22,{fontSize:'11px',color:'rgba(255,255,255,.4)'});
    [[0,'üìà','%24','B√ºy√ºme'],[1,'üí∞','15K','Gelir'],[2,'üë•','1.2K','Kullanƒ±cƒ±'],[3,'‚≠ê','4.8','Puan']].forEach(function(d){
      var bx=52+d[0]*184;
      qs('rounded',bx,112,174,76,'#f8f7ff');
      qt(d[1],bx+10,122,36,36,{fontSize:'22px'});
      qt('<b>'+d[2]+'</b>',bx+50,120,110,32,{fontSize:'22px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif"});
      qt(d[3],bx+50,150,110,22,{fontSize:'11px',color:'#aaa'});
    });
    ['Gƒ∞Rƒ∞≈û','ANALƒ∞Z','BULGULAR','SONU√á'].forEach(function(s,i){
      var y=220+i*195;
      qs('rect',52,y,5,60,'#7c6fff');
      qt(s,66,y,250,24,{fontSize:'9px',fontWeight:'800',color:'#7c6fff',letterSpacing:'2.5px'});
      qt('Bu b√∂l√ºm√ºn i√ßeriƒüi buraya yazƒ±lƒ±r. Detaylar eklenir.',66,y+28,670,55,{fontSize:'13px',color:'#2a2a2a',lineHeight:'1.7'});
      qs('rect',52,y+88,690,1,'#f0f0f5');
    });
  },

  table:function(){
    A4.style.background='#fff';
    qs('rect',0,0,794,84,'#1a1a2e');
    qt('VERƒ∞ TABLOSU',52,18,500,44,{fontSize:'24px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('A√ßƒ±klama satƒ±rƒ± buraya gelir',52,64,400,20,{fontSize:'11px',color:'rgba(255,255,255,.4)'});
    qs('rect',0,84,794,4,'#7c6fff');
    qs('rect',52,102,690,36,'#7c6fff');
    ['#','BA≈ûLIK 1','BA≈ûLIK 2','BA≈ûLIK 3','DURUM'].forEach(function(h,i){qt(h,60+i*138,110,128,20,{fontSize:'9px',fontWeight:'800',color:'#fff',letterSpacing:'1.5px'});});
    for(var r=0;r<8;r++){
      var ry=138+r*38;
      qs('rect',52,ry,690,38,r%2===0?'#f8f7ff':'#fff');
      qs('rect',52,ry+37,690,1,'#f0f0f5');
      [r+1,'Deƒüer A','Deƒüer B','A√ßƒ±klama',r%2===0?'‚úÖ Aktif':'‚è∏ Bekliyor'].forEach(function(d,i){qt(String(d),60+i*138,ry+10,128,22,{fontSize:'12px',color:i===4?(r%2===0?'#11998e':'#f5c842'):'#2a2a2a'});});
    }
  },

  notes:function(){
    A4.style.background='#fffdf5';
    qs('rect',0,0,794,8,'#e87040');
    qs('rect',0,8,794,4,'#f5c842');
    qt('NOTLARIM',52,24,400,46,{fontSize:'26px',fontWeight:'800',color:'#2a2a2a',fontFamily:"'Syne',sans-serif"});
    qt(new Date().toLocaleDateString('tr-TR'),600,32,180,28,{fontSize:'12px',color:'#bbb',textAlign:'right'});
    qs('rect',52,76,690,1,'#e8e4c8');
    for(var i=0;i<16;i++){
      var y=84+i*56;
      qs('circle',46,y+14,8,8,'#fde8d8');
      qs('rect',58,y+28,680,1,'#e8e4c8');
    }
  },

  resume:function(){
    qs('rect',0,0,220,1123,'#1a1a2e');
    qs('rect',220,0,574,1123,'#fff');
    qs('circle',60,40,100,100,'rgba(124,111,255,.3)');
    qt('üë§',85,62,50,56,{fontSize:'36px',textAlign:'center'});
    qt('AD SOYAD',18,155,184,32,{fontSize:'15px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif",textAlign:'center'});
    qt('Unvan / Pozisyon',18,190,184,24,{fontSize:'11px',color:'rgba(255,255,255,.45)',textAlign:'center'});
    qs('rect',40,222,140,1,'rgba(255,255,255,.15)');
    ['üìß email@mail.com','üì± 555 000 0000','üåê linkedin.com/in/ad'].forEach(function(c,i){
      qt(c,16,234+i*28,190,22,{fontSize:'10px',color:'rgba(255,255,255,.6)'});
    });
    ['BECERƒ∞LER','Eƒûƒ∞Tƒ∞M','Dƒ∞LLER'].forEach(function(s,i){
      var sy=340+i*235;
      qs('rect',40,sy,140,1,'rgba(255,255,255,.1)');
      qt(s,16,sy+10,190,20,{fontSize:'9px',fontWeight:'800',color:'rgba(124,111,255,.9)',letterSpacing:'2px'});
      ['Beceri 1 ‚óè‚óè‚óè‚óè‚óã','Beceri 2 ‚óè‚óè‚óè‚óè‚óè','Beceri 3 ‚óè‚óè‚óè‚óã‚óã'].forEach(function(b,j){
        qt(b,16,sy+36+j*36,190,26,{fontSize:'11px',color:'rgba(255,255,255,.7)'});
      });
    });
    qt('DENEYƒ∞M',245,22,450,28,{fontSize:'9px',fontWeight:'800',color:'#7c6fff',letterSpacing:'2.5px'});
    qs('rect',245,54,520,2,'#ede9ff');
    ['≈ûirket A ‚Äî Kƒ±demli Uzman (2022‚ÄìG√ºncel)','≈ûirket B ‚Äî Uzman (2019‚Äì2022)'].forEach(function(job,i){
      var jy=68+i*175;
      qt('<b>'+job.split('‚Äî')[0].trim()+'</b>',245,jy,520,24,{fontSize:'13px',fontWeight:'700',color:'#1a1a2e'});
      qt(job.split('‚Äî')[1]||'',245,jy+24,520,22,{fontSize:'11px',color:'#7c6fff'});
      qt('G√∂rev a√ßƒ±klamasƒ± buraya yazƒ±lƒ±r. Ba≈üarƒ±lar ve sorumluluklar.',245,jy+48,520,55,{fontSize:'12px',color:'#666',lineHeight:'1.7'});
      qs('rect',245,jy+118,520,1,'#f0f0f5');
    });
  },

  timeline:function(){
    A4.style.background='#fff';
    qs('rect',0,0,794,80,'#fff');
    qt('ZAMAN √áƒ∞ZELGESƒ∞',52,22,560,44,{fontSize:'24px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif"});
    qs('rect',0,76,794,4,'#7c6fff');
    qs('rect',128,98,3,950,'#ede9ff');
    var events=[
      {d:'Ocak 2023',t:'Proje Ba≈ülangƒ±cƒ±',desc:'Projenin temel adƒ±mlarƒ± atƒ±ldƒ±.',c:'#7c6fff'},
      {d:'Nisan 2023',t:'ƒ∞lk Milestone',desc:'Hedeflerin ilk kƒ±smƒ± tamamlandƒ±.',c:'#ff6584'},
      {d:'Temmuz 2023',t:'Geli≈ütirme Fazƒ±',desc:'Kapsamlƒ± geli≈ütirme √ßalƒ±≈ümalarƒ±.',c:'#f5c842'},
      {d:'Ekim 2023',t:'Test & Revizyon',desc:'Kalite kontrol ve iyile≈ütirmeler.',c:'#38ef7d'},
      {d:'Ocak 2024',t:'Beta Yayƒ±n',desc:'Sƒ±nƒ±rlƒ± kullanƒ±cƒ± eri≈üimi a√ßƒ±ldƒ±.',c:'#2193b0'},
      {d:'Nisan 2024',t:'Lansman üöÄ',desc:'Resmi yayƒ±n ve kutlama!',c:'#a855f7'}
    ];
    events.forEach(function(ev,i){
      var y=106+i*148;
      qs('circle',116,y,28,28,ev.c);
      qt(i+1+'',122,y+5,18,18,{fontSize:'10px',fontWeight:'800',color:'#fff',textAlign:'center'});
      qs('rounded',158,y,570,110,'#f8f7ff');
      qs('rect',158,y,4,110,ev.c);
      qt(ev.d,172,y+12,220,20,{fontSize:'9px',fontWeight:'700',color:ev.c,letterSpacing:'1px'});
      qt('<b>'+ev.t+'</b>',172,y+34,520,26,{fontSize:'15px',fontWeight:'700',color:'#1a1a2e'});
      qt(ev.desc,172,y+62,520,36,{fontSize:'12px',color:'#777',lineHeight:'1.6'});
    });
  },

  cover:function(){
    A4.style.background='linear-gradient(150deg,#0f0c29 0%,#1a1a4e 50%,#24243e 100%)';
    qs('circle',550,100,300,300,'rgba(124,111,255,.08)');
    qs('circle',620,150,180,180,'rgba(168,85,247,.06)');
    qs('circle',-60,800,250,250,'rgba(255,101,132,.05)');
    qs('rect',0,0,794,5,'#7c6fff');
    qt('‚ú¶',52,380,700,40,{fontSize:'18px',color:'rgba(124,111,255,.7)',textAlign:'center',letterSpacing:'8px'});
    qt('KAPAK<br>BA≈ûLIƒûI',52,430,690,140,{fontSize:'60px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif",textAlign:'center',lineHeight:'1.0'});
    qs('rect',270,584,254,3,'#7c6fff');
    qt('Alt ba≈ülƒ±k veya a√ßƒ±klama metni',52,600,690,38,{fontSize:'16px',color:'rgba(255,255,255,.55)',textAlign:'center',letterSpacing:'1px'});
    qt('2024',52,680,690,30,{fontSize:'12px',color:'rgba(255,255,255,.25)',textAlign:'center',letterSpacing:'8px'});
  },

  invoice:function(){
    A4.style.background='#fff';
    qs('rect',0,0,794,110,'#1a1a2e');
    qt('FATURA',52,22,280,52,{fontSize:'34px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('# 2024-001',450,30,290,32,{fontSize:'14px',color:'rgba(255,255,255,.4)',textAlign:'right'});
    qt('Olu≈üturulma: '+new Date().toLocaleDateString('tr-TR'),450,62,290,22,{fontSize:'10px',color:'rgba(255,255,255,.3)',textAlign:'right'});
    qs('rect',0,110,794,4,'#7c6fff');
    qt('FATURALAYAN',52,128,300,20,{fontSize:'9px',fontWeight:'700',color:'#aaa',letterSpacing:'1.5px'});
    qt('<b>≈ûirket Adƒ± A.≈û.</b>',52,152,300,22,{fontSize:'13px',color:'#1a1a2e'});
    qt('Adres Satƒ±rƒ± 1, ƒ∞l√ße',52,174,300,20,{fontSize:'12px',color:'#666'});
    qt('ƒ∞stanbul, T√ºrkiye',52,194,300,20,{fontSize:'12px',color:'#666'});
    qt('FATURALANAN',430,128,310,20,{fontSize:'9px',fontWeight:'700',color:'#aaa',letterSpacing:'1.5px'});
    qt('<b>M√º≈üteri Adƒ±</b>',430,152,310,22,{fontSize:'13px',color:'#1a1a2e'});
    qt('M√º≈üteri Adresi',430,174,310,20,{fontSize:'12px',color:'#666'});
    qt('≈ûehir, √úlke',430,194,310,20,{fontSize:'12px',color:'#666'});
    qs('rect',52,225,690,36,'#1a1a2e');
    ['√úR√úN / Hƒ∞ZMET','Mƒ∞KTAR','Bƒ∞Rƒ∞M Fƒ∞YAT','TOPLAM'].forEach(function(h,i){qt(h,60+[0,320,455,570][i],233,i===0?250:110,20,{fontSize:'9px',fontWeight:'700',color:'#fff',letterSpacing:'1px'});});
    for(var r=0;r<5;r++){
      var ry=261+r*38;
      qs('rect',52,ry,690,38,r%2===0?'#f8f7ff':'#fff');
      qs('rect',52,ry+37,690,1,'#ede9ff');
      ['√úr√ºn/Hizmet '+(r+1),'1 adet','‚Ç∫'+((r+1)*100),'‚Ç∫'+((r+1)*100)].forEach(function(d,i){qt(d,60+[0,320,455,570][i],ry+10,i===0?250:110,22,{fontSize:'12px',color:'#2a2a2a'});});
    }
    qs('rect',450,465,292,50,'#7c6fff');
    qt('GENEL TOPLAM',458,473,170,16,{fontSize:'9px',fontWeight:'700',color:'rgba(255,255,255,.7)',letterSpacing:'1px'});
    qt('‚Ç∫1.500,00',458,488,276,24,{fontSize:'16px',fontWeight:'800',color:'#fff',textAlign:'right'});
    qt('Bu fatura bilgisayar ortamƒ±nda olu≈üturulmu≈ütur.',52,550,690,22,{fontSize:'10px',color:'#ccc',textAlign:'center'});
  },

  poster:function(){
    A4.style.background='linear-gradient(135deg,#ff6584 0%,#ff8c42 100%)';
    qs('circle',600,50,260,260,'rgba(255,255,255,.06)');
    qs('circle',100,900,200,200,'rgba(0,0,0,.06)');
    qs('rect',0,0,794,5,'rgba(255,255,255,.4)');
    qt('ETKƒ∞NLƒ∞K ADI',52,185,690,120,{fontSize:'58px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif",textAlign:'center',lineHeight:'1.0'});
    qs('rect',270,318,254,3,'rgba(255,255,255,.5)');
    qt('Tarih ¬∑ Saat ¬∑ Yer',52,335,690,36,{fontSize:'15px',color:'rgba(255,255,255,.85)',textAlign:'center',letterSpacing:'1px'});
    qt('Etkinlik a√ßƒ±klamasƒ± buraya gelir.\nDetaylƒ± bilgi ve program.',52,400,690,70,{fontSize:'14px',color:'rgba(255,255,255,.75)',textAlign:'center',lineHeight:'1.7'});
    qs('rounded',247,510,300,56,'rgba(255,255,255,.2)');
    qt('Kayƒ±t Ol / Detaylar',247,524,300,26,{fontSize:'14px',fontWeight:'700',color:'#fff',textAlign:'center'});
  },

  recipe:function(){
    A4.style.background='#fffdf5';
    qs('rect',0,0,794,8,'#e87040');
    qs('rect',0,8,794,3,'#f5c842');
    qt('Tarif Adƒ±',52,28,560,50,{fontSize:'28px',fontWeight:'800',color:'#2a2a2a',fontFamily:"'Syne',sans-serif"});
    ['‚è± 30 dk','üë• 4 ki≈üi','‚ö° Orta'].forEach(function(b,i){
      qs('rounded',52+i*130,82,120,30,'#fff3e0');
      qt(b,52+i*130,88,120,20,{fontSize:'11px',color:'#e87040',textAlign:'center',fontWeight:'600'});
    });
    qs('rect',52,120,690,2,'#ede9ff');
    qt('MALZEMELERr',52,132,280,20,{fontSize:'9px',fontWeight:'800',color:'#e87040',letterSpacing:'2px'});
    ['200g malzeme 1','100ml malzeme 2','3 adet malzeme 3','1 ka≈üƒ±k tuz','Zeytinyaƒüƒ±','Karabiber'].forEach(function(m,i){
      qs('circle',56,156+i*30,8,8,'#fde8d8');
      qt(m,70,150+i*30,260,26,{fontSize:'13px',color:'#2a2a2a'});
    });
    qs('rect',360,120,2,460,'#f0ede0');
    qt('HAZIRILI≈û',378,132,310,20,{fontSize:'9px',fontWeight:'800',color:'#e87040',letterSpacing:'2px'});
    ['Birinci adƒ±m','ƒ∞kinci adƒ±m','√ú√ß√ºnc√º adƒ±m','Pi≈üirme a≈üamasƒ±','Servis'].forEach(function(s,i){
      qs('rounded',378,154+i*76,46,46,'#fff3e0');
      qt(i+1+'',378,163+i*76,46,28,{fontSize:'18px',fontWeight:'800',color:'#e87040',textAlign:'center'});
      qt(s,432,158+i*76,310,30,{fontSize:'13px',color:'#2a2a2a',fontWeight:'600'});
      qt('Detaylƒ± talimat buraya.',432,182+i*76,310,28,{fontSize:'11px',color:'#888',lineHeight:'1.5'});
    });
  },

  flyer:function(){
    A4.style.background='#fff';
    qs('rect',0,0,794,280,'#7c6fff');
    qs('circle',600,20,240,240,'rgba(255,255,255,.06)');
    qt('DUYURU',52,52,690,80,{fontSize:'60px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif",textAlign:'center',lineHeight:'1.0'});
    qt('Ba≈ülƒ±k ve Ana Mesaj Buraya',52,145,690,46,{fontSize:'22px',color:'rgba(255,255,255,.85)',textAlign:'center'});
    qt('Tarih ¬∑ Saat ¬∑ Yer',52,198,690,32,{fontSize:'14px',color:'rgba(255,255,255,.5)',textAlign:'center',letterSpacing:'1px'});
    qt('Detaylƒ± bilgi ve a√ßƒ±klama metni buraya yazƒ±lƒ±r.',70,316,654,65,{fontSize:'15px',color:'#2a2a2a',textAlign:'center',lineHeight:'1.7'});
    ['üìÖ Tarih','üìç Yer','üéü Giri≈ü'].forEach(function(b,i){
      qs('rounded',52+i*246,418,226,68,'#f8f7ff');
      qt(b,52+i*246,432,226,40,{fontSize:'13px',fontWeight:'700',color:'#1a1a2e',textAlign:'center'});
    });
    qs('rounded',247,526,300,52,'#7c6fff');
    qt('ƒ∞leti≈üim / Kayƒ±t Ol',247,540,300,26,{fontSize:'14px',fontWeight:'700',color:'#fff',textAlign:'center'});
  },

  newsletter:function(){
    qs('rect',0,0,794,68,'#1a1a2e');
    qs('rect',0,68,794,4,'#7c6fff');
    qt('B√úLTEN ADI',52,14,400,36,{fontSize:'20px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('Ocak 2024 ¬∑ Sayƒ± 01',450,20,290,24,{fontSize:'11px',color:'rgba(255,255,255,.35)',textAlign:'right'});
    qs('rounded',52,88,430,210,'#f8f7ff');
    qs('rect',52,88,430,4,'#7c6fff');
    qt('√ñNE √áIKAN',60,100,280,20,{fontSize:'9px',fontWeight:'700',color:'#7c6fff',letterSpacing:'1.5px'});
    qt('Ana Haber Ba≈ülƒ±ƒüƒ±',60,124,400,36,{fontSize:'18px',fontWeight:'800',color:'#1a1a2e'});
    qt('Haber i√ßeriƒüi buraya yazƒ±lƒ±r. Kapsamlƒ± ve detaylƒ± bilgi verilir.',60,164,400,65,{fontSize:'12px',color:'#666',lineHeight:'1.7'});
    qt('Devamƒ±nƒ± oku ‚Üí',60,248,200,24,{fontSize:'11px',color:'#7c6fff',fontWeight:'600'});
    qs('rect',496,88,2,860,'#f0f0f5');
    qt('KISA HABERLER',514,100,248,20,{fontSize:'9px',fontWeight:'700',color:'#ff6584',letterSpacing:'1.5px'});
    ['Haber 1 Ba≈ülƒ±ƒüƒ±','Haber 2 Ba≈ülƒ±ƒüƒ±','Haber 3 Ba≈ülƒ±ƒüƒ±'].forEach(function(h,i){
      var hy=126+i*80;
      qs('rect',514,hy,248,1,'#f0f0f5');
      qt(h,514,hy+8,248,22,{fontSize:'12px',fontWeight:'600',color:'#1a1a2e'});
      qt('Kƒ±sa a√ßƒ±klama ve detay.',514,hy+30,248,26,{fontSize:'11px',color:'#aaa',lineHeight:'1.5'});
    });
    qt('YAKIN ETKINLIKLER',52,320,350,20,{fontSize:'9px',fontWeight:'700',color:'#38ef7d',letterSpacing:'1.5px'});
    qs('rect',52,344,430,1,'#f0f0f5');
    ['10 Oca ‚Äî Etkinlik 1','18 Oca ‚Äî Etkinlik 2','25 Oca ‚Äî Etkinlik 3'].forEach(function(ev,i){qt(ev,52,354+i*36,430,26,{fontSize:'12px',color:'#2a2a2a'});});
  },

  certificate:function(){
    A4.style.background='#faf8f0';
    qs('rect',14,14,766,3,'#c9a84c');
    qs('rect',14,14,3,1095,'#c9a84c');
    qs('rect',14,1106,766,3,'#c9a84c');
    qs('rect',777,14,3,1095,'#c9a84c');
    qs('rect',30,30,734,1,'#e8d880');
    qs('rect',30,30,1,1063,'#e8d880');
    qs('rect',30,1093,734,1,'#e8d880');
    qs('rect',764,30,1,1063,'#e8d880');
    qs('circle',44,44,20,20,'#c9a84c');qs('circle',740,44,20,20,'#c9a84c');
    qs('circle',44,1079,20,20,'#c9a84c');qs('circle',740,1079,20,20,'#c9a84c');
    qt('‚ú¶ ‚ú¶ ‚ú¶',52,160,690,30,{fontSize:'14px',color:'#c9a84c',textAlign:'center',letterSpacing:'12px'});
    qt('SERTƒ∞Fƒ∞KA',52,200,690,55,{fontSize:'42px',fontWeight:'800',color:'#c9a84c',fontFamily:'Georgia,serif',textAlign:'center',letterSpacing:'6px'});
    qs('rect',250,264,294,2,'#c9a84c');
    qt('Bu belge ile',52,285,690,28,{fontSize:'14px',color:'#999',textAlign:'center'});
    qt('AD SOYAD',52,322,690,62,{fontSize:'38px',fontWeight:'700',color:'#1a1a2e',fontFamily:'Georgia,serif',textAlign:'center'});
    qs('rect',200,392,394,1,'#e8e0c0');
    qt('ba≈üarƒ±yla tamamladƒ±ƒüƒ± teyit edilir.',52,408,690,30,{fontSize:'14px',color:'#999',textAlign:'center'});
    qt('KONU / PROGRAM ADI',52,448,690,44,{fontSize:'24px',fontWeight:'700',color:'#c9a84c',textAlign:'center',fontFamily:'Georgia,serif'});
    qt('Bu program 40 saatlik eƒüitimden olu≈ümaktadƒ±r.',52,498,690,28,{fontSize:'12px',color:'#bbb',textAlign:'center'});
    qs('rect',160,980,200,2,'#1a1a2e');qt('ƒ∞mza',160,990,200,22,{fontSize:'12px',color:'#888',textAlign:'center'});
    qs('rect',440,980,200,2,'#1a1a2e');qt('Tarih',440,990,200,22,{fontSize:'12px',color:'#888',textAlign:'center'});
  },

  quiz:function(){
    A4.style.background='#fff';
    qs('rect',0,0,794,78,'#1a1a2e');
    qs('rect',0,78,794,4,'#7c6fff');
    qt('SINAV / TEST',52,14,500,46,{fontSize:'24px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('Ad Soyad: ___________________________    Tarih: ________    Puan: ______',52,100,690,26,{fontSize:'11px',color:'#666'});
    qs('rect',52,132,690,1,'#ede9ff');
    for(var q=1;q<=5;q++){
      var qy=144+(q-1)*168;
      qs('rounded',52,qy,36,36,'#7c6fff');
      qt(q+'',52,qy+7,36,22,{fontSize:'13px',fontWeight:'800',color:'#fff',textAlign:'center'});
      qt('Soru '+q+': Soru metni buraya yazƒ±lƒ±r?',94,qy+6,610,26,{fontSize:'13px',fontWeight:'600',color:'#1a1a2e'});
      ['A) ≈ûƒ±k bir','B) ≈ûƒ±k iki','C) ≈ûƒ±k √º√ß','D) ≈ûƒ±k d√∂rt'].forEach(function(s,i){
        qs('rounded',94+i*158,qy+40,148,26,'#f8f7ff');
        qt(s,100+i*158,qy+46,136,18,{fontSize:'11px',color:'#2a2a2a'});
      });
      qs('rect',52,qy+76,690,36,'#f8f7ff');
      qt('Cevap: _______________',62,qy+86,300,20,{fontSize:'11px',color:'#bbb'});
      qs('rect',52,qy+152,690,1,'#ede9ff');
    }
  },

  schedule:function(){
    A4.style.background='#fff';
    qs('rect',0,0,794,78,'#1a1a2e');
    qt('HAFTALIK PROGRAM',52,18,560,44,{fontSize:'22px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('Hafta: _______ ¬∑ Ay: _______',52,58,360,20,{fontSize:'10px',color:'rgba(255,255,255,.35)'});
    var days=['PAZ','PZT','SAL','√áAR','PER','CUM','CMT'];
    var cw2=Math.floor(650/7);
    qs('rect',90,90,700,36,'#f0f0f5');
    days.forEach(function(d,i){qt(d,96+i*cw2,98,cw2-2,20,{fontSize:'9px',fontWeight:'700',color:i===0||i===6?'#ff6584':'#1a1a2e',textAlign:'center',letterSpacing:'1px'});});
    for(var r=0;r<11;r++){
      var ry2=126+r*72;
      qt((8+r)+':00',52,ry2+10,36,20,{fontSize:'9px',color:'#bbb',textAlign:'right'});
      qs('rect',90,ry2,700,72,r%2===0?'#fafafa':'#fff');
      qs('rect',90,ry2+71,700,1,'#f0f0f5');
      days.forEach(function(d,i){qs('rect',91+i*cw2,ry2,1,72,'#f0f0f5');});
    }
  },

  proposal:function(){
    qs('rect',0,0,794,200,'#1a1a2e');
    qs('rect',0,196,794,4,'#7c6fff');
    qs('circle',600,50,240,240,'rgba(124,111,255,.06)');
    qt('PROJE TEKLƒ∞Fƒ∞',52,40,560,55,{fontSize:'32px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('Proje / M√º≈üteri Adƒ±',52,102,500,32,{fontSize:'16px',color:'rgba(255,255,255,.45)'});
    qt(new Date().toLocaleDateString('tr-TR'),52,142,690,24,{fontSize:'11px',color:'rgba(255,255,255,.25)',textAlign:'right'});
    ['PROJE HAKKINDA','KAPSAM','ZAMAN √áƒ∞ZELGESƒ∞','B√úT√áE','ƒ∞LETƒ∞≈ûƒ∞M'].forEach(function(s,i){
      var sy=218+i*156;
      qs('rect',52,sy,4,60,'#7c6fff');
      qt(s,66,sy+4,380,22,{fontSize:'9px',fontWeight:'800',color:'#7c6fff',letterSpacing:'2px'});
      qt('Bu b√∂l√ºm√ºn i√ßeriƒüi buraya yazƒ±lƒ±r. Detaylƒ± bilgi eklenir.',66,sy+30,660,48,{fontSize:'13px',color:'#2a2a2a',lineHeight:'1.7'});
      qs('rect',52,sy+96,690,1,'#f0f0f5');
    });
  },

  journal:function(){
    A4.style.background='#fdf8f0';
    qs('rect',0,0,8,1123,'#e87040');
    qs('rect',8,0,4,1123,'#f5c842');
    qt('üìñ G√ºnl√ºƒü√ºm',28,62,700,44,{fontSize:'24px',fontWeight:'700',color:'#2a2a2a',fontFamily:'Georgia,serif'});
    qt(new Date().toLocaleDateString('tr-TR',{weekday:'long',year:'numeric',month:'long',day:'numeric'}),28,108,730,24,{fontSize:'11px',color:'#c0a882',letterSpacing:'.5px'});
    qs('rect',28,138,740,1,'#e8dcc8');
    qt('Bug√ºn nasƒ±l hissettim?',28,150,400,22,{fontSize:'9px',color:'#c0a882',letterSpacing:'1.5px',fontWeight:'700'});
    for(var i=0;i<8;i++){qs('rect',28,178+i*54,740,1,'#e8dcc8');}
    qt('Minnettar olduklarƒ±m:',28,626,300,22,{fontSize:'9px',color:'#c0a882',letterSpacing:'1.5px',fontWeight:'700'});
    ['1.','2.','3.'].forEach(function(n,i){qt(n+'  ______________________________________',28,652+i*46,460,34,{fontSize:'13px',color:'#2a2a2a'});});
    qt('Yarƒ±n yapacaklarƒ±m:',28,802,300,22,{fontSize:'9px',color:'#c0a882',letterSpacing:'1.5px',fontWeight:'700'});
    ['‚ñ°','‚ñ°','‚ñ°'].forEach(function(n,i){qt(n+'  ______________________________________',28,826+i*46,460,34,{fontSize:'13px',color:'#2a2a2a'});});
  },

  comparison:function(){
    A4.style.background='#fff';
    qt('KAR≈ûILA≈ûTIRMA ANALƒ∞Zƒ∞',52,28,690,42,{fontSize:'22px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif",textAlign:'center'});
    qs('rect',0,78,794,4,'#7c6fff');
    qs('rounded',52,92,326,44,'#11998e');qs('rounded',416,92,326,44,'#ff6584');
    qt('‚úÖ ARTILARI',52,104,326,24,{fontSize:'12px',fontWeight:'800',color:'#fff',textAlign:'center',letterSpacing:'1px'});
    qt('‚ùå EKSƒ∞LERƒ∞',416,104,326,24,{fontSize:'12px',fontWeight:'800',color:'#fff',textAlign:'center',letterSpacing:'1px'});
    qs('rect',389,92,6,900,'#f0f0f5');
    for(var i=0;i<7;i++){
      var iy=148+i*98;
      qs('rounded',60,iy,310,80,'#f0fff8');qs('rect',60,iy,4,80,'#11998e');
      qt('Artƒ± madde '+(i+1),74,iy+10,286,55,{fontSize:'13px',color:'#1a5c35',lineHeight:'1.7'});
      qs('rounded',424,iy,310,80,'#fff0f0');qs('rect',424,iy,4,80,'#ff6584');
      qt('Eksi madde '+(i+1),438,iy+10,286,55,{fontSize:'13px',color:'#5c1a1a',lineHeight:'1.7'});
    }
  },

  swot:function(){
    A4.style.background='#fff';
    qs('rect',0,0,794,80,'#1a1a2e');
    qt('SWOT ANALƒ∞Zƒ∞',52,14,500,42,{fontSize:'24px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('Konu / Proje Adƒ±',52,56,500,24,{fontSize:'12px',color:'rgba(255,255,255,.35)'});
    var quads=[
      {l:'G√ú√áL√ú Y√ñNLER',c:'#2193b0',x:52,y:96,icon:'üí™'},
      {l:'ZAYIF Y√ñNLER',c:'#ff6584',x:421,y:96,icon:'‚ö†Ô∏è'},
      {l:'FIRSATLAR',c:'#38ef7d',x:52,y:590,icon:'üöÄ'},
      {l:'TEHDƒ∞TLER',c:'#f5c842',x:421,y:590,icon:'üõ°'}
    ];
    quads.forEach(function(q){
      qs('rect',q.x,q.y,341,466,'#f8f9fa');
      qs('rect',q.x,q.y,341,46,q.c);
      qt(q.icon+' '+q.l,q.x+8,q.y+12,326,24,{fontSize:'11px',fontWeight:'800',color:'#fff',letterSpacing:'.5px'});
      ['Madde 1','Madde 2','Madde 3','Madde 4'].forEach(function(item,i){
        qs('circle',q.x+14,q.y+62+i*50,8,8,q.c);
        qt(item,q.x+30,q.y+56+i*50,300,36,{fontSize:'13px',color:'#2a2a2a',lineHeight:'1.6'});
      });
    });
    qs('rect',393,96,34,960,'#fff');
    qs('rect',52,580,740,34,'#fff');
  },

  kanban:function(){
    A4.style.background='#f0f0f8';
    qs('rect',0,0,794,80,'#1a1a2e');
    qt('KANBAN PANOSU',52,18,500,44,{fontSize:'22px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('Sprint: ___ ¬∑ Tarih: ___',52,58,400,20,{fontSize:'10px',color:'rgba(255,255,255,.3)'});
    var cols=[{l:'üìã YAPILACAK',c:'#7c6fff',tc:'#fff'},{l:'‚ö° YAPILIYOR',c:'#f5c842',tc:'#1a1a1a'},{l:'‚úÖ TAMAMLANDI',c:'#38ef7d',tc:'#1a1a1a'}];
    cols.forEach(function(col,ci){
      var cx=52+ci*248;
      qs('rounded',cx,90,228,930,'#fff');
      qs('rect',cx,90,228,44,col.c);
      qt(col.l,cx+8,100,212,26,{fontSize:'10px',fontWeight:'700',color:col.tc,letterSpacing:'.5px'});
      for(var i=0;i<4;i++){
        var cy=144+i*106;
        qs('rounded',cx+8,cy,212,90,'#f8f8fc');
        qs('rect',cx+8,cy,4,90,col.c);
        qt('G√∂rev '+(ci*4+i+1),cx+18,cy+10,194,22,{fontSize:'12px',fontWeight:'700',color:'#1a1a2e'});
        qt('A√ßƒ±klama ve detay...',cx+18,cy+34,194,28,{fontSize:'10px',color:'#aaa',lineHeight:'1.5'});
        qt(i%2===0?'üî¥ Y√ºksek':'üü° Orta',cx+18,cy+64,100,18,{fontSize:'9px',color:'#888'});
      }
    });
  },

  infographic:function(){
    A4.style.background='#0f0f1a';
    qs('rect',0,0,794,100,'#7c6fff');
    qs('circle',620,30,200,200,'rgba(255,255,255,.05)');
    qt('ƒ∞NFOGRAFƒ∞K BA≈ûLIƒûI',52,24,690,50,{fontSize:'26px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif",textAlign:'center'});
    qt('Alt ba≈ülƒ±k ve kƒ±sa a√ßƒ±klama',52,74,690,26,{fontSize:'12px',color:'rgba(255,255,255,.5)',textAlign:'center'});
    [['%85','Oran 1','#7c6fff'],['1.2K','Veri 2','#ff6584'],['42','Sayƒ± 3','#f5c842'],['#1','Sƒ±ra','#38ef7d']].forEach(function(s,i){
      var sx=52+i*183;
      qs('rounded',sx,116,168,108,'rgba(255,255,255,.05)');
      qs('rect',sx,116,168,3,s[2]);
      qt(s[0],sx+4,136,160,46,{fontSize:'34px',fontWeight:'800',color:s[2],textAlign:'center',fontFamily:"'Syne',sans-serif"});
      qt(s[1],sx+4,186,160,22,{fontSize:'11px',color:'rgba(255,255,255,.4)',textAlign:'center'});
    });
    qt('ANALƒ∞Z & ORANLAR',52,250,690,24,{fontSize:'9px',fontWeight:'700',color:'rgba(255,255,255,.4)',letterSpacing:'2px',textAlign:'center'});
    var bars=[['Kategori A','#7c6fff',78],['Kategori B','#ff6584',55],['Kategori C','#f5c842',91],['Kategori D','#38ef7d',42],['Kategori E','#2193b0',66]];
    bars.forEach(function(b,i){
      var by=284+i*106;
      qt(b[0],52,by,140,22,{fontSize:'12px',color:'rgba(255,255,255,.6)'});
      qt(b[2]+'%',700,by,52,22,{fontSize:'12px',color:'rgba(255,255,255,.4)',textAlign:'right'});
      qs('rounded',52,by+26,690,24,'rgba(255,255,255,.05)');
      qs('rounded',52,by+26,Math.round(690*b[2]/100),24,b[1]);
    });
  },

  moodboard:function(){
    A4.style.background='#f2f0f8';
    qs('rect',0,0,794,66,'#fff');
    qt('‚ú¶ MOOD BOARD',36,16,500,36,{fontSize:'19px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif"});
    qt('Temayƒ± ¬∑ Rengi ¬∑ Hissi Yansƒ±t',500,22,270,24,{fontSize:'11px',color:'#bbb',textAlign:'right'});
    qs('rect',0,66,794,2,'#ede9ff');
    var blocks=[
      {x:16,y:76,w:375,h:240,c:'#7c6fff',t:'Fotoƒüraf / Renk 1'},
      {x:398,y:76,w:188,h:115,c:'#ff6584',t:'Renk 2'},
      {x:398,y:198,w:188,h:118,c:'#f5c842',t:'Doku'},
      {x:592,y:76,w:186,h:240,c:'#38ef7d',t:'Fotoƒüraf 3'},
      {x:16,y:322,w:188,h:200,c:'#2193b0',t:'Renk 4'},
      {x:210,y:322,w:188,h:200,c:'#e65100',t:'Desen'},
      {x:404,y:322,w:374,h:200,c:'#a855f7',t:'Geni≈ü Alan'}
    ];
    blocks.forEach(function(b){
      qs('rounded',b.x,b.y,b.w,b.h,b.c);
      qt(b.t,b.x+8,b.y+b.h/2-10,b.w-16,22,{fontSize:'10px',color:'rgba(255,255,255,.35)',textAlign:'center'});
    });
    qt('Anahtar Kelimeler:',16,548,200,22,{fontSize:'9px',color:'#bbb',letterSpacing:'1px',fontWeight:'700'});
    ['Minimalist','Modern','Canlƒ±','Doƒüal','Zarif'].forEach(function(w,i){
      qs('rounded',16+i*155,572,140,32,'#fff');
      qt(w,16+i*155,578,140,22,{fontSize:'12px',fontWeight:'700',color:'#1a1a2e',textAlign:'center'});
    });
  }
};

// ---- DRAWING ENGINE ----
function initDrawCanvas(){
  drawCanvas=document.getElementById('drawLayer');
  if(!drawCanvas)return;
  var h=Math.max(1123,A4.scrollHeight||1123);
  drawCanvas.width=794;drawCanvas.height=h;
  drawCanvas.style.height=h+'px';
  drawCtx=drawCanvas.getContext('2d');
  drawCanvas.addEventListener('mousedown',onDrawMousedown);
  drawCanvas.addEventListener('mousemove',onDrawMousemove);
  drawCanvas.addEventListener('mouseup',onDrawMouseup);
  drawCanvas.addEventListener('mouseleave',onDrawMouseup);
}

function setDrawMode(mode){
  drawMode=mode;
  var dl=document.getElementById('drawLayer');
  if(dl){dl.classList.add('active');}
  document.querySelectorAll('.dtb').forEach(function(b){b.classList.remove('on');});
  var btn=document.getElementById('dtb_'+mode);if(btn)btn.classList.add('on');
  toast('√áizim modu: '+mode+' ‚Äî tuval √ºzerinde √ßizin');
}

function stopDrawMode(){
  drawMode=null;
  var dl=document.getElementById('drawLayer');
  if(dl)dl.classList.remove('active');
  document.querySelectorAll('.dtb').forEach(function(b){b.classList.remove('on');});
  toast('√áizim modu kapatƒ±ldƒ±');
}

function setDrawColor(c){
  drawColor=c;
  var cp=document.getElementById('drawColorPicker');if(cp)cp.value=c;
  var ct=document.getElementById('drawColorTxt');if(ct)ct.value=c;
}

function setDrawSize(s){
  drawSize=s;
  document.querySelectorAll('.dsz').forEach(function(b){b.classList.remove('on');});
  buildPanel('drw');
}

function clearDrawings(){
  if(!drawCtx)return;
  drawCtx.clearRect(0,0,drawCanvas.width,drawCanvas.height);
  toast('√áizimler temizlendi');
}

function getA4Pos(e){
  var rect=A4.getBoundingClientRect();
  return {x:e.clientX-rect.left,y:e.clientY-rect.top};
}

var snapImg=null;

function onDrawMousedown(e){
  if(!drawMode||!drawCtx)return;
  e.preventDefault();e.stopPropagation();
  isDrawing=true;
  var p=getA4Pos(e);
  drawStart={x:p.x,y:p.y};
  drawPts=[p];
  if(drawMode!=='pen'){
    snapImg=drawCtx.getImageData(0,0,drawCanvas.width,drawCanvas.height);
  }
  if(drawMode==='pen'){
    drawCtx.beginPath();
    drawCtx.moveTo(p.x,p.y);
    drawCtx.strokeStyle=drawColor;
    drawCtx.lineWidth=drawSize;
    drawCtx.lineCap='round';
    drawCtx.lineJoin='round';
  }
}

function onDrawMousemove(e){
  if(!isDrawing||!drawMode||!drawCtx)return;
  var p=getA4Pos(e);
  if(drawMode==='pen'){
    drawPts.push(p);
    drawCtx.lineTo(p.x,p.y);
    drawCtx.stroke();
  } else {
    if(snapImg)drawCtx.putImageData(snapImg,0,0);
    drawCtx.strokeStyle=drawColor;
    drawCtx.fillStyle=drawColor;
    drawCtx.lineWidth=drawSize;
    drawCtx.lineCap='round';
    drawPreviewShape(drawCtx,drawStart,p,drawMode);
  }
}

function onDrawMouseup(e){
  if(!isDrawing)return;
  isDrawing=false;
  var p=getA4Pos(e);
  if(drawMode!=='pen'){
    if(snapImg)drawCtx.putImageData(snapImg,0,0);
    drawCtx.strokeStyle=drawColor;
    drawCtx.fillStyle=drawColor;
    drawCtx.lineWidth=drawSize;
    drawCtx.lineCap='round';
    drawPreviewShape(drawCtx,drawStart,p,drawMode);
    snapImg=null;
  }
}

function drawPreviewShape(ctx,s,e,mode){
  ctx.beginPath();
  if(mode==='line'){
    ctx.moveTo(s.x,s.y);ctx.lineTo(e.x,e.y);ctx.stroke();
  } else if(mode==='arrow'){
    drawArrow(ctx,s.x,s.y,e.x,e.y,false);
  } else if(mode==='dbl_arrow'){
    drawArrow(ctx,s.x,s.y,e.x,e.y,true);
  } else if(mode==='rect_draw'){
    ctx.strokeRect(s.x,s.y,e.x-s.x,e.y-s.y);
  } else if(mode==='ellipse_draw'){
    var cx=(s.x+e.x)/2,cy=(s.y+e.y)/2,rx=Math.abs(e.x-s.x)/2,ry=Math.abs(e.y-s.y)/2;
    ctx.ellipse(cx,cy,Math.max(1,rx),Math.max(1,ry),0,0,Math.PI*2);
    ctx.stroke();
  }
}

function drawArrow(ctx,x1,y1,x2,y2,dbl){
  var dx=x2-x1,dy=y2-y1;
  var len=Math.sqrt(dx*dx+dy*dy);if(len<2)return;
  var ux=dx/len,uy=dy/len;
  var ah=Math.min(20,len*0.35);
  var aw=ah*0.5;
  ctx.beginPath();
  ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke();
  ctx.beginPath();
  ctx.moveTo(x2,y2);
  ctx.lineTo(x2-ux*ah-uy*aw,y2-uy*ah+ux*aw);
  ctx.lineTo(x2-ux*ah+uy*aw,y2-uy*ah-ux*aw);
  ctx.closePath();ctx.fill();
  if(dbl){
    ctx.beginPath();
    ctx.moveTo(x1,y1);
    ctx.lineTo(x1+ux*ah-uy*aw,y1+uy*ah+ux*aw);
    ctx.lineTo(x1+ux*ah+uy*aw,y1+uy*ah-ux*aw);
    ctx.closePath();ctx.fill();
  }
}

// ---- KEYBOARD ----
document.addEventListener('keydown',function(e){
  if(e.key==='Escape'&&drawMode){stopDrawMode();return;}
  if(e.key==='Delete'&&selId&&document.activeElement.contentEditable!=='true')delEl(selId);
  if((e.ctrlKey||e.metaKey)&&e.key==='z'){e.preventDefault();undoLast();}
  if((e.ctrlKey||e.metaKey)&&e.key==='d'&&selId){e.preventDefault();dupE();}
  if((e.ctrlKey||e.metaKey)&&e.key==='c'&&selId){clipboard=JSON.parse(JSON.stringify(gEl(selId)));toast('Kopyalandƒ±');}
  if((e.ctrlKey||e.metaKey)&&e.key==='v'&&clipboard){ctx_paste();}
  if((e.ctrlKey||e.metaKey)&&e.key==='a'){e.preventDefault();selectAll();}
});

// ---- TOAST ----
function toast(msg){var t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(function(){t.classList.remove('show');},2200);}

// ---- INIT ----
buildPanel('tpl');
setTimeout(function(){initDrawCanvas();},100);
toast('≈ûablon se√ßin veya saƒü tƒ±klayƒ±n! ‚ú¶');
</script>
</body>
</html>
