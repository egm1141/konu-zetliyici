<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>PageCraft</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{background:#111;color:#eee;font-family:'Outfit',sans-serif;height:100vh;display:flex;flex-direction:column;overflow:hidden;user-select:none;}
.topbar{height:50px;background:#1a1a22;border-bottom:1px solid #2a2a38;display:flex;align-items:center;padding:0 14px;gap:10px;flex-shrink:0;}
.logo{font-family:'Syne',sans-serif;font-size:18px;font-weight:800;color:#fff;}
.logo b{color:#6c63ff;}
.tbtn{padding:6px 12px;border-radius:7px;border:1px solid #2a2a38;background:#222;color:#ddd;font-size:12px;cursor:pointer;font-family:'Outfit',sans-serif;transition:all .15s;}
.tbtn:hover{border-color:#6c63ff;color:#6c63ff;}
.tbtn.pri{background:#6c63ff;border-color:#6c63ff;color:#fff;}
.tbtn.pri:hover{background:#5a52e0;}
.sep{width:1px;height:28px;background:#2a2a38;}
.sp{flex:1;}
.main{display:flex;flex:1;overflow:hidden;}
.rail{width:58px;background:#1a1a22;border-right:1px solid #2a2a38;display:flex;flex-direction:column;align-items:center;padding:8px 0;gap:2px;flex-shrink:0;}
.rb{width:46px;height:46px;border-radius:9px;border:1px solid transparent;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .15s;color:#666;font-size:16px;gap:1px;}
.rb span{font-size:8px;color:#555;}
.rb:hover{background:#222;color:#aaa;}
.rb.on{background:#222;border-color:#6c63ff;color:#6c63ff;}
.rb.on span{color:#6c63ff;}
.side{width:270px;background:#1a1a22;border-right:1px solid #2a2a38;overflow-y:auto;flex-shrink:0;}
.side::-webkit-scrollbar{width:4px;}
.side::-webkit-scrollbar-thumb{background:#2a2a38;border-radius:99px;}
.pb{padding:14px;}
.pl{font-size:10px;letter-spacing:1.5px;text-transform:uppercase;color:#555;font-weight:600;margin-bottom:10px;}
.tgrid{display:grid;grid-template-columns:1fr 1fr;gap:7px;}
.tc{background:#222;border:1.5px solid #2a2a38;border-radius:9px;padding:10px 7px;cursor:pointer;text-align:center;transition:all .15s;}
.tc:hover{border-color:#6c63ff;background:#252535;}
.tc-ico{font-size:18px;margin-bottom:4px;}
.tc-name{font-size:10px;color:#888;}
.si{width:100%;background:#222;border:1px solid #2a2a38;border-radius:7px;padding:7px 10px;color:#eee;font-size:12px;font-family:'Outfit',sans-serif;outline:none;margin-bottom:7px;}
.si:focus{border-color:#6c63ff;}
.ss{width:100%;background:#222;border:1px solid #2a2a38;border-radius:7px;padding:7px 8px;color:#eee;font-size:12px;font-family:'Outfit',sans-serif;outline:none;cursor:pointer;margin-bottom:7px;}
.ss:focus{border-color:#6c63ff;}
.cgrid{display:grid;grid-template-columns:repeat(6,1fr);gap:5px;margin-bottom:8px;}
.cd{aspect-ratio:1;border-radius:5px;cursor:pointer;border:2px solid transparent;transition:all .15s;}
.cd:hover{border-color:#fff;transform:scale(1.1);}
.ci{display:flex;gap:7px;align-items:center;margin-bottom:8px;}
.ci input[type=color]{width:34px;height:34px;border:none;border-radius:6px;cursor:pointer;padding:1px;background:#222;}
.ci input[type=text]{flex:1;background:#222;border:1px solid #2a2a38;border-radius:7px;padding:6px 8px;color:#eee;font-size:11px;font-family:monospace;outline:none;}
.ci input[type=text]:focus{border-color:#6c63ff;}
.sbs{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:8px;}
.sbt{width:32px;height:32px;border-radius:6px;border:1px solid #2a2a38;background:#222;color:#eee;font-size:12px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .15s;}
.sbt:hover{background:#6c63ff;border-color:#6c63ff;color:#fff;}
.abs{display:flex;gap:5px;margin-bottom:8px;}
.abt{flex:1;height:30px;border-radius:6px;border:1px solid #2a2a38;background:#222;color:#888;font-size:12px;cursor:pointer;transition:all .15s;}
.abt:hover{background:#6c63ff;border-color:#6c63ff;color:#fff;}
.da{border:2px dashed #2a2a38;border-radius:9px;padding:22px 12px;text-align:center;cursor:pointer;transition:all .2s;background:#1e1e28;position:relative;margin-bottom:10px;}
.da:hover,.da.ov{border-color:#6c63ff;background:rgba(108,99,255,.06);}
.da input{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;}
.pgrid{display:grid;grid-template-columns:1fr 1fr;gap:7px;}
.pth{aspect-ratio:1;border-radius:7px;overflow:hidden;border:2px solid #2a2a38;cursor:pointer;position:relative;transition:border-color .15s;}
.pth:hover{border-color:#6c63ff;}
.pth img{width:100%;height:100%;object-fit:cover;display:block;}
.pth .pd{position:absolute;top:3px;right:3px;background:rgba(0,0,0,.7);border:none;border-radius:50%;width:18px;height:18px;color:#fff;font-size:9px;cursor:pointer;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .15s;}
.pth:hover .pd{opacity:1;}
.shgrid{display:grid;grid-template-columns:repeat(4,1fr);gap:7px;}
.shb{aspect-ratio:1;border-radius:7px;border:1px solid #2a2a38;background:#222;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:16px;transition:all .15s;}
.shb:hover{border-color:#6c63ff;background:#252535;}
.egrid{display:grid;grid-template-columns:repeat(5,1fr);gap:5px;}
.eb{aspect-ratio:1;border-radius:7px;background:#222;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:18px;transition:all .15s;border:1px solid transparent;}
.eb:hover{border-color:#6c63ff;transform:scale(1.08);}
.bggrid{display:grid;grid-template-columns:repeat(3,1fr);gap:7px;margin-bottom:10px;}
.bgsw{aspect-ratio:4/3;border-radius:8px;cursor:pointer;border:2px solid transparent;transition:all .15s;}
.bgsw:hover{border-color:#6c63ff;}
.dv{height:1px;background:#2a2a38;margin:10px 0;}
.cw{flex:1;overflow:auto;background:#0d0d12;display:flex;align-items:flex-start;justify-content:center;padding:28px;}
.cw::-webkit-scrollbar{width:8px;height:8px;}
.cw::-webkit-scrollbar-thumb{background:#2a2a38;border-radius:99px;}
#a4{width:794px;min-height:1123px;background:#fff;position:relative;overflow:hidden;box-shadow:0 20px 70px rgba(0,0,0,.8);border-radius:2px;flex-shrink:0;}
.el{position:absolute;cursor:move;}
.el.sel .ei{outline:2px solid #6c63ff;outline-offset:2px;}
.ei{width:100%;height:100%;position:relative;}
.et{width:100%;height:100%;padding:4px 6px;font-size:15px;line-height:1.5;outline:none;white-space:pre-wrap;word-break:break-word;cursor:text;min-width:30px;min-height:20px;}
.eimg{width:100%;height:100%;object-fit:cover;display:block;pointer-events:none;}
.esvg{width:100%;height:100%;overflow:visible;}
.rh{position:absolute;width:10px;height:10px;background:#6c63ff;border:2px solid #fff;border-radius:2px;bottom:-5px;right:-5px;cursor:se-resize;z-index:10;display:none;}
.dh{position:absolute;top:-11px;right:-11px;width:20px;height:20px;background:#f44;border:2px solid #fff;border-radius:50%;cursor:pointer;font-size:9px;color:#fff;display:none;align-items:center;justify-content:center;z-index:10;}
.el.sel .rh{display:block;}
.el.sel .dh{display:flex;}
.props{width:210px;background:#1a1a22;border-left:1px solid #2a2a38;padding:14px;overflow-y:auto;flex-shrink:0;}
.props::-webkit-scrollbar{width:4px;}
.props::-webkit-scrollbar-thumb{background:#2a2a38;border-radius:99px;}
.prow{display:flex;align-items:center;justify-content:space-between;margin-bottom:9px;gap:7px;}
.plbl{font-size:11px;color:#666;flex-shrink:0;}
.pin{flex:1;background:#222;border:1px solid #2a2a38;border-radius:6px;padding:5px 7px;color:#eee;font-size:11px;text-align:right;font-family:'Outfit',sans-serif;outline:none;}
.pin:focus{border-color:#6c63ff;}
.osl{width:100%;-webkit-appearance:none;height:4px;border-radius:99px;background:#2a2a38;outline:none;cursor:pointer;margin-bottom:12px;}
.osl::-webkit-slider-thumb{-webkit-appearance:none;width:14px;height:14px;border-radius:50%;background:#6c63ff;cursor:pointer;border:2px solid #fff;}
.lbs{display:flex;gap:4px;flex-wrap:wrap;}
.lb{flex:1;min-width:50px;padding:6px 4px;border-radius:6px;border:1px solid #2a2a38;background:#222;color:#ccc;font-size:10px;cursor:pointer;text-align:center;transition:all .15s;font-family:'Outfit',sans-serif;}
.lb:hover{border-color:#6c63ff;color:#6c63ff;}
.lb.red:hover{border-color:#f44;color:#f44;}
.ep{font-size:11px;color:#444;text-align:center;margin-top:40px;line-height:1.7;}
.toast{position:fixed;bottom:22px;right:22px;background:#1a1a22;border:1px solid #2a2a38;border-left:3px solid #6c63ff;color:#eee;padding:10px 15px;border-radius:9px;font-size:12px;z-index:9999;opacity:0;transform:translateY(6px);transition:all .25s;pointer-events:none;}
.toast.show{opacity:1;transform:translateY(0);}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:500;overflow:auto;padding:40px 20px;}
.mbox{background:#1a1a22;border:1px solid #2a2a38;border-radius:14px;width:720px;max-width:100%;margin:0 auto;padding:24px;}
.mhead{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;}
.mtitle{font-family:'Syne',sans-serif;font-size:20px;font-weight:800;}
.mclose{background:#333;border:none;color:#aaa;border-radius:6px;padding:6px 12px;cursor:pointer;font-size:13px;}
.mgrid{display:grid;grid-template-columns:repeat(5,1fr);gap:10px;}
.mc{background:#222;border:1.5px solid #2a2a38;border-radius:10px;padding:14px 8px;cursor:pointer;text-align:center;transition:all .15s;}
.mc:hover{border-color:#6c63ff;}
.mc-ico{font-size:24px;margin-bottom:6px;}
.mc-name{font-size:11px;color:#aaa;font-weight:600;}
@media print{
  .topbar,.rail,.side,.props{display:none!important;}
  body{background:#fff;}
  .cw{padding:0;background:#fff;}
  #a4{box-shadow:none;width:100%;}
  .el.sel .ei{outline:none;}
  .rh,.dh{display:none!important;}
}
</style>
</head>
<body>
<div class="topbar">
  <div class="logo">Page<b>Craft</b></div>
  <div class="sep"></div>
  <button class="tbtn" onclick="openModal()">Sablonlar (25)</button>
  <button class="tbtn" onclick="addTxt('body')">T+ Metin</button>
  <button class="tbtn" onclick="undoLast()">Geri Al</button>
  <button class="tbtn" onclick="clearAll()">Temizle</button>
  <div class="sp"></div>
  <button class="tbtn pri" onclick="window.print()">Yazdir / PDF</button>
</div>
<div class="main">
  <div class="rail">
    <div class="rb on" id="rb_tpl" onclick="showP('tpl',this)">&#128208;<span>Sablon</span></div>
    <div class="rb" id="rb_txt" onclick="showP('txt',this)">T<span>Metin</span></div>
    <div class="rb" id="rb_img" onclick="showP('img',this)">&#128247;<span>Foto</span></div>
    <div class="rb" id="rb_shp" onclick="showP('shp',this)">&#9643;<span>Sekil</span></div>
    <div class="rb" id="rb_stk" onclick="showP('stk',this)">&#11088;<span>Etiket</span></div>
    <div class="rb" id="rb_bg" onclick="showP('bg',this)">&#127912;<span>Arkaplan</span></div>
    <div class="rb" id="rb_fnt" onclick="showP('fnt',this)">Aa<span>Yazi</span></div>
  </div>
  <div class="side" id="sidePanel"></div>
  <div class="cw" id="cw" onclick="desel(event)">
    <div id="a4"></div>
  </div>
  <div class="props" id="props">
    <div class="pl">Ozellikler</div>
    <div class="ep" id="ep">Bir eleman secin</div>
    <div id="pf" style="display:none"></div>
  </div>
</div>
<div class="toast" id="toast"></div>
<div class="modal" id="modal">
  <div class="mbox">
    <div class="mhead">
      <div class="mtitle">Sablon Secin - 25 Format</div>
      <button class="mclose" onclick="closeModal()">Kapat</button>
    </div>
    <div class="mgrid" id="mgrid"></div>
  </div>
</div>
<script>
var els=[],selId=null,undoStack=[],photos=[],elCnt=0,isDrag=false,isRes=false;
var dOff={x:0,y:0},rSt={x:0,y:0,w:0,h:0};
var A4=document.getElementById('a4');

var TPLS=[
  {id:'blank',ico:'&#9633;',name:'Bos Sayfa'},
  {id:'summary',ico:'&#128221;',name:'Ozet'},
  {id:'bullets',ico:'&#128203;',name:'Maddeler'},
  {id:'mindmap',ico:'&#129504;',name:'Beyin Haritasi'},
  {id:'report',ico:'&#128202;',name:'Rapor'},
  {id:'table',ico:'&#128208;',name:'Tablo'},
  {id:'notes',ico:'&#128221;',name:'Defter'},
  {id:'resume',ico:'&#128100;',name:'CV'},
  {id:'timeline',ico:'&#9202;',name:'Zaman Cizelgesi'},
  {id:'cover',ico:'&#127912;',name:'Kapak'},
  {id:'invoice',ico:'&#129534;',name:'Fatura'},
  {id:'poster',ico:'&#128204;',name:'Afis'},
  {id:'recipe',ico:'&#127859;',name:'Tarif'},
  {id:'flyer',ico:'&#128226;',name:'El Ilani'},
  {id:'newsletter',ico:'&#128240;',name:'Bulten'},
  {id:'certificate',ico:'&#127942;',name:'Sertifika'},
  {id:'quiz',ico:'&#10067;',name:'Sinav'},
  {id:'schedule',ico:'&#128197;',name:'Program'},
  {id:'proposal',ico:'&#128188;',name:'Teklif'},
  {id:'journal',ico:'&#128214;',name:'Gunluk'},
  {id:'comparison',ico:'&#9878;',name:'Karsilastirma'},
  {id:'swot',ico:'&#128310;',name:'SWOT'},
  {id:'kanban',ico:'&#128193;',name:'Kanban'},
  {id:'infographic',ico:'&#128200;',name:'Infografik'},
  {id:'moodboard',ico:'&#10024;',name:'Mood Board'}
];

// ---- PANEL ----
function showP(name,btn){
  document.querySelectorAll('.rb').forEach(function(b){b.classList.remove('on');});
  btn.classList.add('on');
  buildPanel(name);
}

function buildPanel(name){
  var sp=document.getElementById('sidePanel');
  var h='';
  if(name==='tpl'){
    h='<div class="pb"><div class="pl">Sablonlar</div><div class="tgrid">';
    TPLS.forEach(function(t){
      h+='<div class="tc" onclick="applyTpl(\''+t.id+'\')"><div class="tc-ico">'+t.ico+'</div><div class="tc-name">'+t.name+'</div></div>';
    });
    h+='</div></div>';
  } else if(name==='txt'){
    h='<div class="pb"><div class="pl">Metin Ekle</div>';
    var txts=[['heading','Buyuk Baslik','36px, Kalin'],['sub','Alt Baslik','20px, Orta'],['body','Paragraf','14px'],['caption','Aciklama','11px'],['quote','"Alinti"','16px, Italik']];
    txts.forEach(function(v){
      h+='<div class="tc" style="text-align:left;padding:10px 12px;margin-bottom:7px;" onclick="addTxt(\''+v[0]+'\')"><div style="font-weight:600;color:#eee;font-size:13px;">'+v[1]+'</div><div style="font-size:10px;color:#555;margin-top:2px;">'+v[2]+'</div></div>';
    });
    h+='</div>';
  } else if(name==='img'){
    h='<div class="pb"><div class="pl">Fotograflar</div>'
     +'<div class="da" id="da"><input type="file" accept="image/*" multiple onchange="uploadP(this.files)">'
     +'<div style="font-size:28px;margin-bottom:6px;">&#128247;</div>'
     +'<div style="font-size:12px;color:#666;">Fotograf ekle veya<br><b style="color:#6c63ff">surukle birak</b></div>'
     +'</div><div class="pgrid" id="pgrid"></div></div>';
  } else if(name==='shp'){
    var shapes=[['rect','&#9644;'],['circle','&#9679;'],['triangle','&#9650;'],['diamond','&#9670;'],['star','&#9733;'],['line','&#9473;'],['rounded','&#9635;'],['arrow','&#10148;'],['hexagon','&#11043;'],['plus','&#10010;']];
    h='<div class="pb"><div class="pl">Sekiller</div><div class="shgrid">';
    shapes.forEach(function(s){h+='<div class="shb" onclick="addShp(\''+s[0]+'\')">'+s[1]+'</div>';});
    h+='</div><div class="dv"></div><div class="pl">Renk</div><div class="cgrid">';
    ['#6c63ff','#ff6584','#f5c842','#38ef7d','#2193b0','#1a1a2e','#fff','#f44','#ff8c42','#a855f7','#11998e','#e65100'].forEach(function(c){
      h+='<div class="cd" style="background:'+c+'" onclick="applyShpColor(\''+c+'\')"></div>';
    });
    h+='</div><div class="ci"><input type="color" value="#6c63ff" oninput="applyShpColor(this.value)"><input type="text" value="#6c63ff" placeholder="#renk" oninput="applyShpColor(this.value)"></div></div>';
  } else if(name==='stk'){
    var stks=['&#11088;','&#128293;','&#128161;','&#9989;','&#10060;','&#9888;','&#127919;','&#128204;','&#128273;','&#128142;','&#128640;','&#127775;','&#128170;','&#127881;','&#127942;','&#10024;','&#127912;','&#128221;','&#128276;','&#128188;','&#128077;','&#10084;','&#127769;','&#9728;','&#9889;'];
    h='<div class="pb"><div class="pl">Cikartmalar</div><div class="egrid">';
    stks.forEach(function(s){h+='<div class="eb" onclick="addStk(\''+s+'\')">'+s+'</div>';});
    h+='</div></div>';
  } else if(name==='bg'){
    var bgs=[
      'background:#fff','background:#faf8f3','background:#f0f0f5',
      'background:#1a1a2e','background:#111','background:#fffde7',
      'background:linear-gradient(135deg,#6c63ff,#a855f7)',
      'background:linear-gradient(135deg,#ff6584,#ff8c42)',
      'background:linear-gradient(135deg,#11998e,#38ef7d)',
      'background:linear-gradient(135deg,#2193b0,#6dd5ed)',
      'background:#fff;background-image:repeating-linear-gradient(0deg,transparent,transparent 27px,#ddd 28px)',
      'background:#fff;background-image:linear-gradient(#e5e5e5 1px,transparent 1px),linear-gradient(90deg,#e5e5e5 1px,transparent 1px);background-size:28px 28px'
    ];
    window._bgs=bgs;
    h='<div class="pb"><div class="pl">Arkaplan</div><div class="bggrid">';
    bgs.forEach(function(b,i){h+='<div class="bgsw" style="'+b+'" onclick="applyBg('+i+')"></div>';});
    h+='</div><div class="ci"><input type="color" value="#ffffff" oninput="A4.style.background=this.value"><input type="text" placeholder="#ffffff" oninput="A4.style.background=this.value"></div></div>';
  } else if(name==='fnt'){
    h='<div class="pb"><div class="pl">Yazi Tipi</div>'
     +'<select class="ss" onchange="applyFF(this.value)">'
     +"<option value=\"'Outfit',sans-serif\">Outfit</option>"
     +"<option value=\"'Syne',sans-serif\">Syne</option>"
     +'<option value="Georgia,serif">Georgia</option>'
     +'<option value="\'Times New Roman\',serif">Times New Roman</option>'
     +'<option value="\'Courier New\',monospace">Courier New</option>'
     +'<option value="Arial,sans-serif">Arial</option>'
     +'</select>'
     +'<div class="pl">Boyut</div>'
     +'<select class="ss" onchange="applyFS(this.value)">';
    [8,10,11,12,13,14,16,18,20,22,24,28,32,36,40,48,56,64,72,80,96].forEach(function(s){
      h+='<option value="'+s+'px"'+(s===14?' selected':'')+'>'+s+'</option>';
    });
    h+='</select><div class="pl">Stil</div><div class="sbs">'
     +'<button class="sbt" onclick="applyB()"><b>B</b></button>'
     +'<button class="sbt" onclick="applyI()"><i>I</i></button>'
     +'<button class="sbt" onclick="applyU()"><u>U</u></button>'
     +'</div><div class="pl">Hizala</div><div class="abs">'
     +'<button class="abt" onclick="applyA(\'left\')">&#8676;</button>'
     +'<button class="abt" onclick="applyA(\'center\')">&#8596;</button>'
     +'<button class="abt" onclick="applyA(\'right\')">&#8677;</button>'
     +'</div><div class="pl">Renk</div><div class="cgrid">';
    ['#1a1a1a','#fff','#6c63ff','#ff6584','#f5c842','#38ef7d','#2193b0','#f44','#888','#000','#a855f7','#e65100'].forEach(function(c){
      h+='<div class="cd" style="background:'+c+';'+(c==='#fff'?'border:1px solid #333;':'')+'" onclick="applyTC(\''+c+'\')"></div>';
    });
    h+='</div><div class="ci"><input type="color" value="#1a1a1a" oninput="applyTC(this.value)"><input type="text" value="#1a1a1a" oninput="applyTC(this.value)"></div></div>';
  }
  sp.innerHTML=h;
  if(name==='img'){setupDrop();renderPG();}
}

// ---- PHOTOS ----
function setupDrop(){
  var da=document.getElementById('da');
  if(!da)return;
  da.addEventListener('dragover',function(e){e.preventDefault();da.classList.add('ov');});
  da.addEventListener('dragleave',function(){da.classList.remove('ov');});
  da.addEventListener('drop',function(e){e.preventDefault();da.classList.remove('ov');uploadP(e.dataTransfer.files);});
}
function uploadP(files){
  Array.from(files).forEach(function(f){
    var r=new FileReader();
    r.onload=function(e){photos.push(e.target.result);renderPG();toast('Fotograf eklendi');};
    r.readAsDataURL(f);
  });
}
function renderPG(){
  var g=document.getElementById('pgrid');
  if(!g)return;
  g.innerHTML=photos.map(function(src,i){
    return '<div class="pth" onclick="addImg('+i+')">'
     +'<img src="'+src+'">'
     +'<button class="pd" onclick="event.stopPropagation();photos.splice('+i+',1);renderPG()">X</button>'
     +'</div>';
  }).join('');
}

// ---- CREATE EL ----
function mkEl(type,cfg){
  saveUndo();
  var id='e'+(++elCnt);
  var el={id:id,type:type,x:cfg.x||60,y:cfg.y||60,w:cfg.w||200,h:cfg.h||50,cnt:cfg.cnt||'',st:cfg.st||{},shp:cfg.shp||null,img:cfg.img!=null?cfg.img:null,z:els.length+1};
  els.push(el);
  drawEl(el);
  return el;
}

function drawEl(el){
  var old=document.getElementById(el.id);
  if(old)old.remove();
  var div=document.createElement('div');
  div.className='el';div.id=el.id;
  div.style.left=el.x+'px';div.style.top=el.y+'px';
  div.style.width=el.w+'px';div.style.height=el.h+'px';
  div.style.zIndex=el.z;
  var inner=document.createElement('div');inner.className='ei';
  if(el.type==='text'){
    var t=document.createElement('div');t.className='et';t.contentEditable='true';t.innerHTML=el.cnt;
    applyStyle(t,el.st);
    t.addEventListener('input',function(){el.cnt=t.innerHTML;});
    t.addEventListener('mousedown',function(e){e.stopPropagation();});
    inner.appendChild(t);
  } else if(el.type==='image'){
    var img=document.createElement('img');img.className='eimg';img.src=photos[el.img];inner.appendChild(img);
  } else if(el.type==='shape'){
    var svg=mkSVG(el);inner.appendChild(svg);
  } else if(el.type==='sticker'){
    var sd=document.createElement('div');
    sd.style.cssText='width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:'+(el.h*0.65)+'px;';
    sd.innerHTML=el.cnt;inner.appendChild(sd);
  }
  var rh=document.createElement('div');rh.className='rh';rh.addEventListener('mousedown',startRes);inner.appendChild(rh);
  var dh=document.createElement('div');dh.className='dh';dh.textContent='X';
  dh.addEventListener('mousedown',function(e){e.stopPropagation();delEl(el.id);});inner.appendChild(dh);
  div.appendChild(inner);
  div.addEventListener('mousedown',startDrag);
  A4.appendChild(div);
}

function applyStyle(el,st){
  if(!st)return;
  if(st.fontSize)el.style.fontSize=st.fontSize;
  if(st.fontWeight)el.style.fontWeight=st.fontWeight;
  if(st.fontStyle)el.style.fontStyle=st.fontStyle;
  if(st.fontFamily)el.style.fontFamily=st.fontFamily;
  if(st.color)el.style.color=st.color;
  if(st.textAlign)el.style.textAlign=st.textAlign;
  if(st.textDecoration)el.style.textDecoration=st.textDecoration;
  if(st.lineHeight)el.style.lineHeight=st.lineHeight;
  if(st.background)el.style.background=st.background;
  if(st.padding)el.style.padding=st.padding;
}

function mkSVG(el){
  var svg=document.createElementNS('http://www.w3.org/2000/svg','svg');
  svg.setAttribute('width','100%');svg.setAttribute('height','100%');svg.style.overflow='visible';
  var c=(el.st&&el.st.fill)||'#6c63ff';
  var m={
    rect:'<rect x="1" y="1" width="99%" height="99%" fill="'+c+'"/>',
    rounded:'<rect x="1" y="1" width="99%" height="99%" rx="10" fill="'+c+'"/>',
    circle:'<ellipse cx="50%" cy="50%" rx="49%" ry="49%" fill="'+c+'"/>',
    triangle:'<polygon points="50%,2% 98%,98% 2%,98%" fill="'+c+'"/>',
    diamond:'<polygon points="50%,2% 98%,50% 50%,98% 2%,50%" fill="'+c+'"/>',
    star:'<polygon points="50%,5% 61%,35% 98%,35% 68%,57% 79%,91% 50%,70% 21%,91% 32%,57% 2%,35% 39%,35%" fill="'+c+'"/>',
    line:'<line x1="0" y1="50%" x2="100%" y2="50%" stroke="'+c+'" stroke-width="4"/>',
    arrow:'<polygon points="60%,15% 98%,50% 60%,85% 60%,65% 2%,65% 2%,35% 60%,35%" fill="'+c+'"/>',
    hexagon:'<polygon points="25%,2% 75%,2% 98%,50% 75%,98% 25%,98% 2%,50%" fill="'+c+'"/>',
    plus:'<rect x="40%" y="5%" width="20%" height="90%" fill="'+c+'"/><rect x="5%" y="40%" width="90%" height="20%" fill="'+c+'"/>'
  };
  svg.innerHTML=m[el.shp]||m.rect;
  return svg;
}

// ---- DRAG ----
function startDrag(e){
  if(e.target.classList.contains('rh')||e.target.classList.contains('dh'))return;
  var div=e.currentTarget;selEl(div.id);
  if(e.target.contentEditable==='true')return;
  isDrag=true;dOff.x=e.clientX-div.offsetLeft;dOff.y=e.clientY-div.offsetTop;
  e.preventDefault();
  document.addEventListener('mousemove',onDrag);document.addEventListener('mouseup',stopDrag);
}
function onDrag(e){
  if(!isDrag||!selId)return;
  var div=document.getElementById(selId);if(!div)return;
  var el=gEl(selId);
  el.x=Math.max(0,e.clientX-dOff.x);el.y=Math.max(0,e.clientY-dOff.y);
  div.style.left=el.x+'px';div.style.top=el.y+'px';
  refProps();
}
function stopDrag(){isDrag=false;document.removeEventListener('mousemove',onDrag);document.removeEventListener('mouseup',stopDrag);}

// ---- RESIZE ----
function startRes(e){
  e.stopPropagation();isRes=true;
  var div=document.getElementById(selId);
  rSt={x:e.clientX,y:e.clientY,w:div.offsetWidth,h:div.offsetHeight};
  document.addEventListener('mousemove',onRes);document.addEventListener('mouseup',stopRes);
}
function onRes(e){
  if(!isRes||!selId)return;
  var el=gEl(selId),div=document.getElementById(selId);
  el.w=Math.max(30,rSt.w+(e.clientX-rSt.x));el.h=Math.max(15,rSt.h+(e.clientY-rSt.y));
  div.style.width=el.w+'px';div.style.height=el.h+'px';
  if(el.type==='sticker'){var sd=div.querySelector('.ei>div');if(sd)sd.style.fontSize=(el.h*0.65)+'px';}
  refProps();
}
function stopRes(){isRes=false;document.removeEventListener('mousemove',onRes);document.removeEventListener('mouseup',stopRes);}

// ---- SELECT ----
function selEl(id){
  desel();selId=id;
  var div=document.getElementById(id);if(div)div.classList.add('sel');
  refProps();
}
function desel(e){
  if(e&&e.target.closest&&(e.target.closest('.el')||e.target.closest('.props')))return;
  document.querySelectorAll('.el').forEach(function(d){d.classList.remove('sel');});
  selId=null;
  document.getElementById('ep').style.display='block';
  document.getElementById('pf').style.display='none';
}
function gEl(id){return els.find(function(e){return e.id===id;});}
function delEl(id){saveUndo();els=els.filter(function(e){return e.id!==id;});var d=document.getElementById(id);if(d)d.remove();selId=null;desel();}

function refProps(){
  if(!selId)return;
  var el=gEl(selId);if(!el)return;
  document.getElementById('ep').style.display='none';
  var pf=document.getElementById('pf');pf.style.display='block';
  pf.innerHTML=
    '<div class="prow"><span class="plbl">X</span><input class="pin" type="number" value="'+Math.round(el.x)+'" onchange="mvP(\'x\',this.value)"></div>'
   +'<div class="prow"><span class="plbl">Y</span><input class="pin" type="number" value="'+Math.round(el.y)+'" onchange="mvP(\'y\',this.value)"></div>'
   +'<div class="prow"><span class="plbl">Genislik</span><input class="pin" type="number" value="'+Math.round(el.w)+'" onchange="szP(\'w\',this.value)"></div>'
   +'<div class="prow"><span class="plbl">Yukseklik</span><input class="pin" type="number" value="'+Math.round(el.h)+'" onchange="szP(\'h\',this.value)"></div>'
   +'<div class="plbl">Opaklik</div>'
   +'<input class="osl" type="range" min="0" max="100" value="'+Math.round((el.st.opacity!=null?el.st.opacity:1)*100)+'" oninput="setOp(this.value)">'
   +'<div class="dv"></div><div class="lbs">'
   +'<button class="lb" onclick="bF()">One</button>'
   +'<button class="lb" onclick="sB()">Arkaya</button>'
   +'<button class="lb" onclick="dupE()">Kopyala</button>'
   +'<button class="lb red" onclick="delEl(\''+el.id+'\')">Sil</button>'
   +'</div>';
}
function mvP(ax,v){var el=gEl(selId);if(!el)return;el[ax]=+v;var d=document.getElementById(selId);if(d)d.style[ax==='x'?'left':'top']=v+'px';}
function szP(d,v){var el=gEl(selId);if(!el)return;el[d]=+v;var div=document.getElementById(selId);if(div)div.style[d==='w'?'width':'height']=v+'px';}
function setOp(v){var el=gEl(selId);if(!el)return;el.st.opacity=v/100;document.getElementById(selId).style.opacity=v/100;}
function bF(){var el=gEl(selId);if(!el)return;var mx=Math.max.apply(null,els.map(function(e){return e.z;}))+1;el.z=mx;document.getElementById(selId).style.zIndex=mx;}
function sB(){var el=gEl(selId);if(!el)return;var mn=Math.max(1,Math.min.apply(null,els.map(function(e){return e.z;}))-1);el.z=mn;document.getElementById(selId).style.zIndex=mn;}
function dupE(){var el=gEl(selId);if(!el)return;var ne=mkEl(el.type,{x:el.x+18,y:el.y+18,w:el.w,h:el.h,cnt:el.cnt,st:Object.assign({},el.st),shp:el.shp,img:el.img});selEl(ne.id);}

// ---- STYLE ----
function aTS(fn){if(!selId)return;fn(gEl(selId),document.getElementById(selId));}
function gTxt(div){return div?div.querySelector('.et'):null;}
function applyTC(c){aTS(function(el,div){el.st.color=c;var t=gTxt(div);if(t)t.style.color=c;});}
function applyFF(f){aTS(function(el,div){el.st.fontFamily=f;var t=gTxt(div);if(t)t.style.fontFamily=f;});}
function applyFS(s){aTS(function(el,div){el.st.fontSize=s;var t=gTxt(div);if(t)t.style.fontSize=s;});}
function applyB(){aTS(function(el,div){var t=gTxt(div);if(!t)return;var b=window.getComputedStyle(t).fontWeight;var nb=(b==='700'||b==='bold')?'400':'700';t.style.fontWeight=nb;el.st.fontWeight=nb;});}
function applyI(){aTS(function(el,div){var t=gTxt(div);if(!t)return;var c=window.getComputedStyle(t).fontStyle;var ni=c==='italic'?'normal':'italic';t.style.fontStyle=ni;el.st.fontStyle=ni;});}
function applyU(){aTS(function(el,div){var t=gTxt(div);if(!t)return;t.style.textDecoration=t.style.textDecoration==='underline'?'none':'underline';});}
function applyA(a){aTS(function(el,div){var t=gTxt(div);if(t){t.style.textAlign=a;el.st.textAlign=a;}});}
function applyShpColor(c){aTS(function(el,div){if(el.type!=='shape')return;el.st.fill=c;var svg=div.querySelector('svg');if(svg){var ns=mkSVG(el);div.querySelector('.ei').replaceChild(ns,svg);}});}
function applyBg(i){var bg=window._bgs[i];if(!bg)return;A4.style.cssText=bg+';width:794px;min-height:1123px;position:relative;overflow:hidden;box-shadow:0 20px 70px rgba(0,0,0,.8);border-radius:2px;flex-shrink:0;';toast('Arkaplan degistirildi');}

// ---- ADD HELPERS ----
function addTxt(v){
  var m={
    heading:{cnt:'Buyuk Baslik',st:{fontSize:'34px',fontWeight:'700',fontFamily:"'Syne',sans-serif",color:'#1a1a1a'},w:450,h:60},
    sub:{cnt:'Alt Baslik',st:{fontSize:'20px',fontWeight:'600',fontFamily:"'Outfit',sans-serif",color:'#1a1a1a'},w:350,h:40},
    body:{cnt:'Metninizi buraya yazin...',st:{fontSize:'14px',fontFamily:"'Outfit',sans-serif",color:'#2a2a2a',lineHeight:'1.7'},w:350,h:70},
    caption:{cnt:'Aciklama metni',st:{fontSize:'11px',color:'#888'},w:220,h:28},
    quote:{cnt:'"Alinti metni buraya gelir"',st:{fontSize:'16px',fontStyle:'italic',color:'#555',fontFamily:'Georgia,serif'},w:340,h:55}
  };
  var cfg=m[v]||m.body;
  var ne=mkEl('text',{cnt:cfg.cnt,st:cfg.st,w:cfg.w,h:cfg.h,x:60,y:60+els.length*12});
  selEl(ne.id);toast('Metin eklendi');
}
function addShp(shp){var ne=mkEl('shape',{shp:shp,st:{fill:'#6c63ff'},w:130,h:80,x:80,y:80+els.length*8});selEl(ne.id);}
function addStk(em){var ne=mkEl('sticker',{cnt:em,w:60,h:60,x:100,y:100+els.length*6});selEl(ne.id);}
function addImg(idx){var ne=mkEl('image',{img:parseInt(idx),w:220,h:170,x:80,y:80+els.length*8});selEl(ne.id);}

// ---- UNDO / CLEAR ----
function saveUndo(){undoStack.push(A4.innerHTML);if(undoStack.length>20)undoStack.shift();}
function undoLast(){if(!undoStack.length)return;A4.innerHTML=undoStack.pop();els=[];selId=null;toast('Geri alindi');}
function clearAll(silent){saveUndo();A4.innerHTML='';els=[];selId=null;A4.style.cssText='background:#fff;width:794px;min-height:1123px;position:relative;overflow:hidden;box-shadow:0 20px 70px rgba(0,0,0,.8);border-radius:2px;flex-shrink:0;';if(!silent)toast('Temizlendi');}

// ---- MODAL ----
function openModal(){
  var g=document.getElementById('mgrid');
  g.innerHTML=TPLS.map(function(t){
    return '<div class="mc" onclick="applyTpl(\''+t.id+'\');closeModal()">'
     +'<div class="mc-ico">'+t.ico+'</div>'
     +'<div class="mc-name">'+t.name+'</div></div>';
  }).join('');
  document.getElementById('modal').style.display='block';
}
function closeModal(){document.getElementById('modal').style.display='none';}
document.getElementById('modal').addEventListener('click',function(e){if(e.target===this)closeModal();});

// ---- TEMPLATES ----
function applyTpl(id){clearAll(true);var fn=TFNS[id];if(fn)fn();else toast(id+' yuklendi');}

function qt(text,x,y,w,h,s){return mkEl('text',{cnt:text,x:x,y:y,w:w||300,h:h||36,st:s||{}});}
function qs(shp,x,y,w,h,fill){return mkEl('shape',{shp:shp,x:x,y:y,w:w,h:h,st:{fill:fill||'#6c63ff'}});}

var TFNS={
  blank:function(){},
  summary:function(){
    A4.style.background='#fff';
    qt('<b>BASLIK BURAYA</b>',60,55,670,58,{fontSize:'30px',fontFamily:"'Syne',sans-serif",fontWeight:'800',color:'#1a1a1a'});
    qt('Tarih - Yazar - Kaynak',60,122,450,24,{fontSize:'12px',color:'#999'});
    qs('line',60,152,670,5,'#1a1a2e');
    qt('Birinci paragraf buraya gelir. Konuya giris yapin.',60,168,670,70,{fontSize:'14px',lineHeight:'1.8',color:'#2a2a2a'});
    qt('Ikinci paragraf daha fazla detay icerir.',60,248,670,70,{fontSize:'14px',lineHeight:'1.8',color:'#2a2a2a'});
    qt('Sonuc cumlesi buraya.',60,328,670,40,{fontSize:'14px',lineHeight:'1.8',color:'#2a2a2a'});
  },
  bullets:function(){
    A4.style.background='#fff';
    qt('MADDE MADDE',60,50,600,52,{fontSize:'26px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif"});
    qs('rect',60,110,670,4,'#6c63ff');
    var y=126;
    [['BOLUM 1',['Birinci madde icerigi','Ikinci madde icerigi','Ucuncu madde icerigi']],
     ['BOLUM 2',['Dorduncu madde','Besinci madde','Altinci madde']],
     ['BOLUM 3',['Yedinci madde','Sekizinci madde']]].forEach(function(sec){
       qt(sec[0],60,y,400,26,{fontSize:'10px',fontWeight:'700',color:'#6c63ff',letterSpacing:'2px'});y+=32;
       sec[1].forEach(function(item){qt('- '+item,72,y,630,28,{fontSize:'13.5px',color:'#2a2a2a',lineHeight:'1.7'});y+=32;});
       y+=14;
    });
  },
  mindmap:function(){
    A4.style.background='#f8f8ff';
    qt('Beyin Haritasi',200,30,394,44,{fontSize:'22px',fontWeight:'800',fontFamily:"'Syne',sans-serif",color:'#1a1a2e',textAlign:'center'});
    qs('circle',297,440,200,120,'#6c63ff');
    qt('MERKEZ KONU',315,488,165,30,{fontSize:'13px',fontWeight:'700',color:'#fff',textAlign:'center'});
    [{t:'Dal 1',x:55,y:305},{t:'Dal 2',x:515,y:305},{t:'Dal 3',x:55,y:510},{t:'Dal 4',x:515,y:510},{t:'Dal 5',x:180,y:195},{t:'Dal 6',x:415,y:195},{t:'Dal 7',x:165,y:695},{t:'Dal 8',x:445,y:695}].forEach(function(n){
      qs('rounded',n.x,n.y,145,50,'#fff');
      qt(n.t,n.x+6,n.y+13,132,28,{fontSize:'12px',fontWeight:'600',color:'#1a1a2e',textAlign:'center'});
    });
  },
  report:function(){
    qs('rect',0,0,794,90,'#1a1a2e');
    qt('RAPOR BASLIGI',60,18,550,55,{fontSize:'26px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    ['GIRIS','ANALIZ','BULGULAR','SONUC'].forEach(function(s,i){
      var y=130+i*200;
      qs('rect',60,y,5,55,'#f5c842');
      qt(s,74,y,250,26,{fontSize:'11px',fontWeight:'700',color:'#1a1a2e',letterSpacing:'2px'});
      qt('Bu bolumun icerigi buraya yazilir. Detaylar eklenir.',74,y+30,640,55,{fontSize:'13px',color:'#2a2a2a',lineHeight:'1.7'});
    });
  },
  table:function(){
    A4.style.background='#fff';
    qt('VERI TABLOSU',60,50,500,48,{fontSize:'24px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif"});
    qs('rect',60,108,670,36,'#1a1a2e');
    ['#','BASLIK 1','BASLIK 2','BASLIK 3'].forEach(function(h,i){qt(h,68+i*165,116,155,20,{fontSize:'10px',fontWeight:'700',color:'#fff',letterSpacing:'1px'});});
    for(var r=0;r<7;r++){var ry=144+r*36;qs('rect',60,ry,670,36,r%2===0?'#f8f8f8':'#fff');[r+1,'Veri','Deger','Not'].forEach(function(d,i){qt(String(d),68+i*165,ry+8,155,22,{fontSize:'13px',color:'#2a2a2a'});});}
  },
  notes:function(){
    A4.style.background='#fffdf0';
    qs('rect',0,0,794,6,'#e87040');
    qt('NOTLAR',60,24,300,48,{fontSize:'28px',fontWeight:'800',color:'#2a2a2a',fontFamily:'Georgia,serif'});
    for(var i=0;i<16;i++){qs('line',60,96+i*54,670,2,'#e8e4c8');qt('',68,100+i*54,658,40,{fontSize:'14px',color:'#3a3a2a'});}
  },
  resume:function(){
    qs('rect',0,0,794,140,'#1a1a2e');
    qt('AD SOYAD',40,36,400,52,{fontSize:'30px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('Unvan / Pozisyon',40,95,300,32,{fontSize:'15px',color:'rgba(255,255,255,.6)'});
    qs('rect',0,190,230,933,'#f8f8f8');
    ['EGITIM','BECERILER','ILETISIM'].forEach(function(s,i){
      qt(s,14,210+i*240,200,22,{fontSize:'10px',fontWeight:'700',color:'#6c63ff',letterSpacing:'2px'});
      qt('Icerik buraya...',14,240+i*240,200,80,{fontSize:'12px',color:'#2a2a2a',lineHeight:'1.7'});
    });
    qt('DENEYIM',245,210,470,22,{fontSize:'10px',fontWeight:'700',color:'#1a1a2e',letterSpacing:'2px'});
    qt('Sirket - Pozisyon (2020-2024)',245,240,470,26,{fontSize:'13px',fontWeight:'600',color:'#1a1a2e'});
    qt('Gorev aciklamasi buraya yazilir.',245,270,470,55,{fontSize:'12px',color:'#666',lineHeight:'1.7'});
  },
  timeline:function(){
    A4.style.background='#fff';
    qt('ZAMAN CIZELGESI',60,44,500,46,{fontSize:'24px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif"});
    qs('line',128,110,3,880,'#e8e8e8');
    ['Ocak 2023','Nisan 2023','Temmuz 2023','Ekim 2023','Ocak 2024','Nisan 2024'].forEach(function(d,i){
      var y=118+i*155;
      qs('circle',114,y,26,26,i%2===0?'#6c63ff':'#ff6584');
      qt(d,162,y,180,24,{fontSize:'10px',fontWeight:'700',color:i%2===0?'#6c63ff':'#ff6584'});
      qt('Olay basligi',162,y+26,450,26,{fontSize:'15px',fontWeight:'700',color:'#1a1a2e'});
      qt('Aciklama buraya.',162,y+54,450,38,{fontSize:'12px',color:'#777',lineHeight:'1.6'});
    });
  },
  cover:function(){
    A4.style.background='linear-gradient(135deg,#1a1a2e 0%,#0f3460 100%)';
    qs('rect',0,0,794,5,'#6c63ff');
    qt('KAPAK BASLIGI',80,340,634,110,{fontSize:'52px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif",textAlign:'center',lineHeight:'1.1'});
    qs('line',220,470,354,3,'#f5c842');
    qt('Alt baslik veya slogan',80,490,634,42,{fontSize:'18px',color:'rgba(255,255,255,.7)',textAlign:'center'});
  },
  invoice:function(){
    A4.style.background='#fff';
    qt('FATURA',60,44,280,52,{fontSize:'32px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif"});
    qt('No: #001',450,44,280,52,{fontSize:'12px',color:'#888',textAlign:'right'});
    qs('line',60,106,670,2,'#1a1a2e');
    qt('Kimden:\nSirket Adi\nAdres',60,120,300,65,{fontSize:'12px',color:'#2a2a2a',lineHeight:'1.6'});
    qt('Kime:\nMusteri Adi\nAdres',430,120,280,65,{fontSize:'12px',color:'#2a2a2a',lineHeight:'1.6'});
    qs('rect',60,205,670,34,'#1a1a2e');
    ['URUN','MIKTAR','FIYAT','TOPLAM'].forEach(function(h,i){qt(h,68+i*165,213,155,20,{fontSize:'10px',fontWeight:'700',color:'#fff'});});
    for(var r=0;r<5;r++){var ry=239+r*36;qs('rect',60,ry,670,36,r%2===0?'#f8f8f8':'#fff');['Urun '+(r+1),'1','100 TL','100 TL'].forEach(function(d,i){qt(d,68+i*165,ry+8,155,22,{fontSize:'13px',color:'#2a2a2a'});});}
    qs('rect',450,460,280,36,'#6c63ff');
    qt('TOPLAM: 500 TL',458,468,264,22,{fontSize:'13px',fontWeight:'700',color:'#fff'});
  },
  poster:function(){
    A4.style.background='linear-gradient(135deg,#ff6584,#ff8c42)';
    qt('ETKINLIK ADI',60,200,674,100,{fontSize:'56px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif",textAlign:'center'});
    qs('line',200,315,394,3,'rgba(255,255,255,.5)');
    qt('Tarih - Saat - Yer',60,336,674,38,{fontSize:'15px',color:'rgba(255,255,255,.9)',textAlign:'center'});
    qt('Etkinlik aciklamasi buraya.',100,410,594,70,{fontSize:'14px',color:'rgba(255,255,255,.8)',textAlign:'center',lineHeight:'1.7'});
    qs('rounded',270,520,254,52,'rgba(255,255,255,.15)');
    qt('Detayli Bilgi',272,533,250,26,{fontSize:'14px',fontWeight:'700',color:'#fff',textAlign:'center'});
  },
  recipe:function(){
    A4.style.background='#fffdf0';
    qs('rect',0,0,794,5,'#e87040');
    qt('Tarif Adi',60,26,500,52,{fontSize:'28px',fontWeight:'800',color:'#2a2a2a',fontFamily:'Georgia,serif'});
    qt('30 dk - 4 kisi - Orta',60,82,450,26,{fontSize:'12px',color:'#999'});
    qs('line',60,114,670,2,'#e8e4c8');
    qt('MALZEMELER',60,128,280,22,{fontSize:'10px',fontWeight:'700',color:'#e87040',letterSpacing:'2px'});
    ['200g malzeme 1','100ml malzeme 2','3 adet malzeme 3','1 kasik tuz','Zeytinyagi'].forEach(function(m,i){qt('- '+m,60,154+i*28,280,24,{fontSize:'13px',color:'#2a2a2a'});});
    qt('HAZIRLAYIS',380,128,280,22,{fontSize:'10px',fontWeight:'700',color:'#e87040',letterSpacing:'2px'});
    ['1. Ilk adim','2. Ikinci adim','3. Ucuncu adim','4. Pisirme','5. Servis'].forEach(function(s,i){qt(s,380,154+i*52,330,44,{fontSize:'13px',color:'#2a2a2a',lineHeight:'1.6'});});
  },
  flyer:function(){
    A4.style.background='#fff';
    qs('rect',0,0,794,300,'#6c63ff');
    qt('DUYURU',60,72,674,68,{fontSize:'56px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif",textAlign:'center'});
    qt('Baslik ve Ana Mesaj',60,152,674,48,{fontSize:'22px',color:'rgba(255,255,255,.85)',textAlign:'center'});
    qt('Tarih - Saat - Yer',60,210,674,34,{fontSize:'14px',color:'rgba(255,255,255,.6)',textAlign:'center'});
    qt('Detayli bilgi buraya yazilir.',80,340,634,70,{fontSize:'15px',color:'#2a2a2a',textAlign:'center',lineHeight:'1.7'});
    qs('rounded',247,450,300,52,'#6c63ff');
    qt('Iletisim / Kayit',247,463,300,26,{fontSize:'14px',fontWeight:'700',color:'#fff',textAlign:'center'});
  },
  newsletter:function(){
    qs('rect',0,0,794,64,'#1a1a2e');
    qt('BULTEN ADI',60,16,500,34,{fontSize:'20px',fontWeight:'700',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('ONEMLI HABER',60,82,355,24,{fontSize:'10px',fontWeight:'700',color:'#6c63ff',letterSpacing:'1.5px'});
    qt('Haber Basligi',60,108,355,38,{fontSize:'18px',fontWeight:'700',color:'#1a1a2e'});
    qt('Haber icerigi buraya yazilir.',60,150,355,65,{fontSize:'13px',color:'#666',lineHeight:'1.7'});
    qs('line',428,80,2,250,'#e8e8e8');
    qt('KISA HABERLER',448,82,280,24,{fontSize:'10px',fontWeight:'700',color:'#ff6584',letterSpacing:'1.5px'});
    ['Haber 1','Haber 2','Haber 3'].forEach(function(h,i){
      qt('- '+h,448,112+i*64,280,22,{fontSize:'13px',fontWeight:'600',color:'#1a1a2e'});
      qt('Kisa aciklama',448,136+i*64,280,22,{fontSize:'11px',color:'#999'});
    });
  },
  certificate:function(){
    A4.style.background='#faf8f3';
    qt('SERTIFIKA',80,170,634,52,{fontSize:'38px',fontWeight:'800',color:'#c9a84c',fontFamily:'Georgia,serif',textAlign:'center',letterSpacing:'5px'});
    qs('line',200,232,394,2,'#c9a84c');
    qt('Bu belge ile,',80,260,634,30,{fontSize:'14px',color:'#888',textAlign:'center'});
    qt('AD SOYAD',80,300,634,58,{fontSize:'34px',fontWeight:'700',color:'#1a1a2e',fontFamily:'Georgia,serif',textAlign:'center'});
    qt('basari ile tamamladigi teyit edilir.',80,368,634,30,{fontSize:'14px',color:'#888',textAlign:'center'});
    qt('KONU ADI',80,410,634,42,{fontSize:'22px',fontWeight:'700',color:'#c9a84c',textAlign:'center'});
    qs('line',150,970,200,2,'#1a1a2e');qt('Imza',150,978,200,22,{fontSize:'12px',color:'#888',textAlign:'center'});
    qs('line',450,970,200,2,'#1a1a2e');qt('Tarih',450,978,200,22,{fontSize:'12px',color:'#888',textAlign:'center'});
  },
  quiz:function(){
    A4.style.background='#fff';
    qt('SINAV / TEST',60,44,500,46,{fontSize:'24px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif"});
    qt('Ad Soyad: ________________________    Tarih: __________',60,96,670,26,{fontSize:'12px',color:'#666'});
    qs('line',60,128,670,2,'#e8e8e8');
    for(var q=1;q<=5;q++){var qy=140+(q-1)*168;qt('Soru '+q+': Soru metni buraya yazilir?',60,qy,670,28,{fontSize:'14px',fontWeight:'600',color:'#1a1a2e'});['A) Sik bir','B) Sik iki','C) Sik uc','D) Sik dort'].forEach(function(s,i){qt(s,80+i*158,qy+32,150,22,{fontSize:'12px',color:'#2a2a2a'});});qs('rect',60,qy+62,670,36,'#f8f8f8');qt('Cevap: ___________',68,qy+72,200,20,{fontSize:'11px',color:'#aaa'});qs('line',60,qy+150,670,1,'#e8e8e8');}
  },
  schedule:function(){
    A4.style.background='#fff';
    qt('HAFTALIK PROGRAM',60,44,560,44,{fontSize:'22px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif"});
    var days=['PAZ','PZT','SAL','CAR','PER','CUM','CMT'];
    var cw=Math.floor(670/7);
    qs('rect',60,98,670,34,'#1a1a2e');
    days.forEach(function(d,i){qt(d,68+i*cw,106,cw-2,18,{fontSize:'9px',fontWeight:'700',color:i===0||i===6?'#ff6584':'#fff',textAlign:'center'});});
    for(var r=0;r<11;r++){qs('rect',60,132+r*70,670,70,r%2===0?'#f8f8f8':'#fff');qt((8+r)+':00',14,144+r*70,44,16,{fontSize:'9px',color:'#bbb',textAlign:'right'});}
  },
  proposal:function(){
    qs('rect',0,0,794,190,'#1a1a2e');
    qs('rect',0,184,794,6,'#6c63ff');
    qt('PROJE TEKLIFI',60,46,500,52,{fontSize:'30px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif"});
    qt('Proje / Musteri Adi',60,108,500,34,{fontSize:'15px',color:'rgba(255,255,255,.5)'});
    ['PROJE HAKKINDA','KAPSAM','ZAMAN CIZELGESI','BUTCE','ILETISIM'].forEach(function(s,i){
      var sy=215+i*160;
      qs('rect',60,sy,6,55,'#6c63ff');
      qt(s,76,sy+3,380,22,{fontSize:'10px',fontWeight:'700',color:'#6c63ff',letterSpacing:'1.5px'});
      qt('Bu bolumun icerigi buraya yazilir.',76,sy+28,640,48,{fontSize:'13px',color:'#2a2a2a',lineHeight:'1.7'});
    });
  },
  journal:function(){
    A4.style.background='#fdf9f0';
    qs('rect',0,0,6,1123,'#e87040');
    qt('Gunluk...',24,76,700,46,{fontSize:'26px',fontWeight:'700',color:'#2a2a2a',fontFamily:'Georgia,serif'});
    qs('line',24,128,750,1,'#e8dcc8');
    qt('Bugun nasil hissettim?',24,144,400,22,{fontSize:'10px',color:'#c0a882',letterSpacing:'1px'});
    for(var i=0;i<8;i++){qs('line',24,172+i*52,750,1,'#e8dcc8');qt('',30,174+i*52,740,36,{fontSize:'14px',color:'#2a2a2a',lineHeight:'1.7'});}
    qt('Minnettar olduklarim:',24,608,300,22,{fontSize:'10px',color:'#c0a882',letterSpacing:'1px'});
    ['1.','2.','3.'].forEach(function(n,i){qt(n+'  ____________________________________',24,634+i*44,440,34,{fontSize:'13px',color:'#2a2a2a'});});
  },
  comparison:function(){
    A4.style.background='#fff';
    qt('KARSILASTIRMA',197,44,400,44,{fontSize:'22px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif",textAlign:'center'});
    qs('rect',60,98,310,42,'#38ef7d');qs('rect',424,98,310,42,'#ff6584');
    qt('ARTILARI',60,108,310,26,{fontSize:'12px',fontWeight:'700',color:'#fff',textAlign:'center'});
    qt('EKSILERI',424,108,310,26,{fontSize:'12px',fontWeight:'700',color:'#fff',textAlign:'center'});
    qs('line',390,98,2,900,'#e8e8e8');
    for(var i=0;i<7;i++){
      var iy=152+i*100;
      qs('rounded',68,iy,295,82,'#f0fff4');qt('Arti madde '+(i+1),78,iy+10,275,56,{fontSize:'13px',color:'#1a5c35',lineHeight:'1.7'});
      qs('rounded',432,iy,295,82,'#fff0f0');qt('Eksi madde '+(i+1),442,iy+10,275,56,{fontSize:'13px',color:'#5c1a1a',lineHeight:'1.7'});
    }
  },
  swot:function(){
    A4.style.background='#fff';
    qt('SWOT ANALIZI',60,44,500,44,{fontSize:'24px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif"});
    qt('Konu / Proje Adi',60,90,500,26,{fontSize:'13px',color:'#999'});
    [{l:'GUCLU',c:'#2193b0',x:60,y:130},{l:'ZAYIF',c:'#ff6584',x:427,y:130},{l:'FIRSAT',c:'#38ef7d',x:60,y:616},{l:'TEHDIT',c:'#f5c842',x:427,y:616}].forEach(function(q){
      qs('rect',q.x,q.y,337,460,'#f8f8f8');qs('rect',q.x,q.y,337,42,q.c);
      qt(q.l,q.x+8,q.y+10,320,24,{fontSize:'12px',fontWeight:'700',color:'#fff'});
      ['Madde 1','Madde 2','Madde 3'].forEach(function(item,i){qt('- '+item,q.x+12,q.y+56+i*46,310,36,{fontSize:'13px',color:'#2a2a2a',lineHeight:'1.6'});});
    });
  },
  kanban:function(){
    A4.style.background='#f5f5fa';
    qt('KANBAN PANOSU',60,44,500,44,{fontSize:'22px',fontWeight:'800',color:'#1a1a2e',fontFamily:"'Syne',sans-serif"});
    [{l:'YAPILACAK',c:'#6c63ff'},{l:'YAPILIYOR',c:'#f5c842'},{l:'TAMAMLANDI',c:'#38ef7d'}].forEach(function(col,ci){
      var cx=60+ci*245;
      qs('rect',cx,98,225,900,'#fff');qs('rect',cx,98,225,36,col.c);
      qt(col.l,cx+5,106,215,22,{fontSize:'9px',fontWeight:'700',color:ci===1?'#1a1a1a':'#fff'});
      for(var i=0;i<4;i++){qs('rounded',cx+8,142+i*100,209,82,'#f8f8f8');qt('Gorev '+(ci*4+i+1),cx+16,150+i*100,190,22,{fontSize:'13px',fontWeight:'600',color:'#1a1a2e'});qt('Aciklama...',cx+16,174+i*100,190,32,{fontSize:'11px',color:'#aaa',lineHeight:'1.5'});}
    });
  },
  infographic:function(){
    A4.style.background='#1a1a2e';
    qs('rect',0,0,794,110,'#6c63ff');
    qt('INFOGRAFIK BASLIGI',60,28,674,55,{fontSize:'28px',fontWeight:'800',color:'#fff',fontFamily:"'Syne',sans-serif",textAlign:'center'});
    [['%85','Oran 1'],['1.2K','Sayi 2'],['42','Veri 3'],['#1','Sira']].forEach(function(s,i){
      var sx=60+i*178;
      qs('rounded',sx,128,158,108,'rgba(255,255,255,.07)');
      qt(s[0],sx+4,148,150,42,{fontSize:'32px',fontWeight:'800',color:'#f5c842',textAlign:'center',fontFamily:"'Syne',sans-serif"});
      qt(s[1],sx+4,194,150,22,{fontSize:'11px',color:'rgba(255,255,255,.55)',textAlign:'center'});
    });
    ['Kategori A','Kategori B','Kategori C','Kategori D'].forEach(function(cat,i){
      var cy=278+i*115;
      qt(cat,60,cy,155,22,{fontSize:'12px',color:'rgba(255,255,255,.7)'});
      qs('rounded',218,cy,452,20,'rgba(255,255,255,.1)');
      qs('rounded',218,cy,[75,50,90,35][i]/100*452,20,'#6c63ff');
      qt([75,50,90,35][i]+'%',680,cy,58,20,{fontSize:'11px',color:'rgba(255,255,255,.5)',textAlign:'right'});
    });
  },
  moodboard:function(){
    A4.style.background='#f0f0f5';
    qs('rect',0,0,794,72,'#fff');
    qt('MOOD BOARD',36,18,400,38,{fontSize:'20px',fontWeight:'700',color:'#1a1a2e',fontFamily:"'Syne',sans-serif"});
    [{x:18,y:80,w:365,h:230,c:'#6c63ff'},{x:392,y:80,w:182,h:110,c:'#ff6584'},{x:392,y:198,w:182,h:112,c:'#f5c842'},{x:582,y:80,w:194,h:230,c:'#38ef7d'},{x:18,y:318,w:182,h:200,c:'#2193b0'},{x:208,y:318,w:182,h:200,c:'#e65100'},{x:398,y:318,w:378,h:200,c:'#a855f7'}].forEach(function(b){
      qs('rect',b.x,b.y,b.w,b.h,b.c);qt('Foto / Renk',b.x+8,b.y+b.h/2-10,b.w-16,22,{fontSize:'10px',color:'rgba(255,255,255,.4)',textAlign:'center'});
    });
    ['Kelime','Tema','Renk','Doku','His'].forEach(function(w,i){qt(w,18+i*155,544,145,30,{fontSize:'13px',fontWeight:'700',color:'#1a1a2e',textAlign:'center'});});
  }
};

// ---- KEYBOARD ----
document.addEventListener('keydown',function(e){
  if(e.key==='Delete'&&selId&&document.activeElement.contentEditable!=='true')delEl(selId);
  if((e.ctrlKey||e.metaKey)&&e.key==='z'){e.preventDefault();undoLast();}
  if((e.ctrlKey||e.metaKey)&&e.key==='d'&&selId){e.preventDefault();dupE();}
});

// ---- TOAST ----
function toast(msg){var t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(function(){t.classList.remove('show');},2200);}

// ---- INIT ----
buildPanel('tpl');
toast('Sablon secin veya eleman ekleyin!');
</script>
</body>
</html>
